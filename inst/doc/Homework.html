<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jiaqi Wu" />

<meta name="date" content="2020-12-19" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Jiaqi Wu</h4>
<h4 class="date">2020-12-19</h4>



<div id="homework-09.22" class="section level2">
<h2>Homework-09.22</h2>
</div>
<div id="example1" class="section level2">
<h2>Example1</h2>
<p>Below are the scatter plots of Violent Crime Rates by US State:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">pairs</span>(USArrests, <span class="dt">pch=</span><span class="dv">23</span>, <span class="dt">bg=</span><span class="st">&#39;orange&#39;</span>,                                          </span>
<span id="cb1-2"><a href="#cb1-2"></a>      <span class="dt">cex.labels=</span><span class="fl">1.5</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example2" class="section level2">
<h2>Example2</h2>
<p>Below is the head of the data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(USArrests))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Murder</th>
<th align="right">Assault</th>
<th align="right">UrbanPop</th>
<th align="right">Rape</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">13.2</td>
<td align="right">236</td>
<td align="right">58</td>
<td align="right">21.2</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">10.0</td>
<td align="right">263</td>
<td align="right">48</td>
<td align="right">44.5</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">8.1</td>
<td align="right">294</td>
<td align="right">80</td>
<td align="right">31.0</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">8.8</td>
<td align="right">190</td>
<td align="right">50</td>
<td align="right">19.5</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">9.0</td>
<td align="right">276</td>
<td align="right">91</td>
<td align="right">40.6</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">7.9</td>
<td align="right">204</td>
<td align="right">78</td>
<td align="right">38.7</td>
</tr>
</tbody>
</table>
</div>
<div id="example3" class="section level2">
<h2>Example3</h2>
<p>Here are a few facts about multiple linear regression: <span class="math display">\[Y_i = \beta_0 + \beta_1 X_{i1} + \dots + \beta_p X_{ip} + \varepsilon_i\]</span> <span class="math display">\[\begin{aligned}
       SSE(\beta_0, \dots, \beta_p) &amp;= \sum_{i=1}^n\left(Y_i - \left(\beta_0 + \sum_{j=1}^p \beta_j \
X_{ij} \right) \right)^2 \\
       &amp;= \|Y - \widehat{Y}(\beta)\|^2
       \end{aligned}\]</span> <span class="math display">\[\widehat{\sigma}^2 = \frac{SSE}{n-p-1} \sim \sigma^2 \cdot \frac{\chi^2_{n-p-1}}{n-p\
-1}\]</span></p>
</div>
<div id="homework-09.29" class="section level2">
<h2>Homework-09.29</h2>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>The Pareto <span class="math inline">\((a, b)\)</span> distribution has cdf <span class="math display">\[
F(x)=1-\left(\frac{b}{x}\right)^{a}, \quad x \geq b&gt;0, a&gt;0.
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto<span class="math inline">\((2, 2)\)</span> distribution. Graph the density histogram of the sample with the Pareto <span class="math inline">\((2,2)\)</span> density superimposed for comparison.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>If <span class="math inline">\(X\sim Pareto(2, 2)\)</span>, then for <span class="math inline">\(x&gt;0\)</span> the cdf of <span class="math inline">\(X\)</span> is <span class="math inline">\(F_X(x)=1-\left(\frac{2}{x}\right)^{2}\)</span>. The inverse transformation is <span class="math inline">\(F_X^{-1}(u)=\frac{2}{\sqrt{1-u}}\)</span>. Note <span class="math inline">\(U\)</span> and <span class="math inline">\(1-U\)</span> have the same distribution, we generate <span class="math inline">\(X\)</span> with <span class="math inline">\(x= \frac{2}{\sqrt{u}}\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(u)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">hist</span>(x, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&#39;Pareto(2,2)&#39;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">breaks=</span><span class="dv">500</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="fl">.1</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>(y<span class="op">^</span><span class="dv">3</span>),<span class="dt">lwd =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the empirical and theoretical distributions approximately agree.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[
f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1.
\]</span> Devroye and Györfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_{1}, U_{2}, U_{3} \sim\)</span> Uniform <span class="math inline">\((-1,1) .\)</span> If <span class="math inline">\(\left|U_{3}\right| \geq\)</span> <span class="math inline">\(\left|U_{2}\right|\)</span> and <span class="math inline">\(\left|U_{3}\right| \geq\left|U_{1}\right|,\)</span> deliver <span class="math inline">\(U_{2} ;\)</span> otherwise deliver <span class="math inline">\(U_{3} .\)</span> Write a function to generate random variates from <span class="math inline">\(f_{e},\)</span> and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>repan &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb4-2"><a href="#cb4-2"></a>   u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span><span class="op">*</span>n, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb4-4"><a href="#cb4-4"></a>   <span class="cf">if</span>(<span class="kw">abs</span>(u[<span class="dv">3</span><span class="op">*</span>i]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u[<span class="dv">3</span><span class="op">*</span>i<span class="dv">-1</span>]) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(u[<span class="dv">3</span><span class="op">*</span>i]) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u[<span class="dv">3</span><span class="op">*</span>i<span class="dv">-2</span>])) x[i] &lt;-<span class="st"> </span>u[<span class="dv">3</span><span class="op">*</span>i<span class="dv">-1</span>] <span class="cf">else</span> x[i] &lt;-<span class="st"> </span>u[<span class="dv">3</span><span class="op">*</span>i]</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span>
<span id="cb4-6"><a href="#cb4-6"></a>   <span class="kw">return</span>(x)</span>
<span id="cb4-7"><a href="#cb4-7"></a>}</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>x &lt;-<span class="st"> </span><span class="kw">repan</span>(<span class="dv">10000</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">hist</span>(x, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&#39;Epanechnikov kernel&#39;</span>, <span class="dt">breaks =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>Consider this alternative description of the same algorithm:</p>
<p>1.Generate iid <span class="math inline">\(U_1,U_2,U_3\)</span> with Uniform<span class="math inline">\((0,1)\)</span> distributions.</p>
<p>2.Select one of the two smallest of the <span class="math inline">\(U_i\)</span> at random, with equal probability. Call this value X.</p>
<p>3.Randomly negate X with probability <span class="math inline">\(\frac 1 2\)</span>.</p>
<p>Note that X is indeed distributed from the mixture of the distributions of the first order statistic and of the second order statistic for three uniforms on (0,1).Thus,</p>
<p><span class="math display">\[f_X(x)=\frac1 2 f_{U_{(1)}}(x)+\frac1 2 f_{U_{(2)}}(x)=\frac1 2 3(1-x)^2+\frac1 2 6x(1-x)=\frac3 2-\frac3 {2}x^2.\]</span> According to the third step in the alternative description, extending f to the domain <span class="math inline">\([−1,1]\)</span> by symmetry. As <span class="math inline">\((-x)^2=x^2\)</span>, we can get <span class="math inline">\(f_e(x)\)</span> with <span class="math display">\[f_e(x)=\frac1 2 f_X(x)=\frac{3}{4}\left(1-x^{2}\right).\]</span></p>
<p>This completes the proof.</p>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[
F(y)=1-\left(\frac{\beta}{\beta+y}\right)^{r}, \quad y \geq 0.
\]</span> Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2 .\)</span> Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))<span class="op">/</span>u<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">hist</span>(x, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&#39;Pareto&#39;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">breaks=</span><span class="dv">100</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.1</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">lines</span>(y, <span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>,<span class="dt">lwd =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the empirical and theoretical distributions approximately agree.</p>
</div>
<div id="homework-10.13" class="section level2">
<h2>Homework-10.13</h2>
</div>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t,
\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>We can straightly compute <span class="math inline">\(\int_{0}^{\pi / 3} \sin t d t=-\left.\cos t\right|_{0} ^{\pi / 3}=\frac 1 2\)</span>. Thus the exact value is 0.5.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5009124</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">print</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>We can see that the estimate is close to the exact value.</p>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>Refer to Exercise <span class="math inline">\(5.6 .\)</span> Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6 .</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>We first compute the theoretical percent reduction in variance as above: <span class="math display">\[\frac{Var(e^U)-Var(\frac{e^U+e^{1-U}}{2})}{Var(e^U)}=\frac{\frac 1 2 Var(e^U)-\frac 1 2Cov(e^U,e^{1-U})}{Var(e^U)}=\frac1 2 -\frac{e-(e-1)^2}{2(\frac{e^{2}-1}{2}-(e-1)^{2})}\doteq0.983835.\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>m &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>U &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb10-4"><a href="#cb10-4"></a>T1 &lt;-<span class="st"> </span><span class="kw">exp</span>(U)</span>
<span id="cb10-5"><a href="#cb10-5"></a>T2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(U)<span class="op">+</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>U)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">mean</span>(T1)</span></code></pre></div>
<pre><code>## [1] 1.719013</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">mean</span>(T2)</span></code></pre></div>
<pre><code>## [1] 1.71812</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>(<span class="kw">var</span>(T1)<span class="op">-</span><span class="kw">var</span>(T2))<span class="op">/</span><span class="kw">var</span>(T1)</span></code></pre></div>
<pre><code>## [1] 0.9837697</code></pre>
<p>We can see that empirical estimate of the percent reduction in variance is similiar to the theoretical.</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>If <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta,\)</span> and <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{*}=1 / 2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_{c}=c \hat{\theta}_{1}+(1-c) \hat{\theta}_{2} .\)</span> Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta,\)</span> find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_{c}=c \hat{\theta}_{1}+(1-c) \hat{\theta}_{2}\)</span> in equation <span class="math inline">\((5.11) .\left(c^{*}\right.\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Note that <span class="math display">\[Var(\hat{\theta}_c)=Var\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)c^{2} +2 Cov\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)c +Var\left(\hat{\theta}_{2}\right).\]</span> Thus the quadratic function of <span class="math inline">\(c\)</span> arrives its minimum at <span class="math display">\[c^*=-\frac {Cov\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)}{Var\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)}=\frac{Var(\hat{\theta}_{2})-Cov(\hat{\theta}_{1},\hat{\theta}_{2})}{Var(\hat{\theta}_{1})-2Cov(\hat{\theta}_{1},\hat{\theta}_{2})+Var(\hat{\theta}_{2})}.\]</span></p>
</div>
<div id="homework-10.20" class="section level2">
<h2>Homework-10.20</h2>
</div>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1,
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x,
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math display">\[
\begin{aligned}
&amp;f_{1}(x)=e^{1-x}, \quad 1&lt;x&lt;\infty,\\
&amp;f_2(x)=4(1+x^2)^{-1}/\pi, \quad 1&lt;x&lt;\infty.
\end{aligned}
\]</span> We will use inverse transform method to generate from <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb16-6"><a href="#cb16-6"></a>  x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>}</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="co">#f1,inverse transform method</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(u)</span>
<span id="cb16-11"><a href="#cb16-11"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb16-12"><a href="#cb16-12"></a>theta_hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb16-13"><a href="#cb16-13"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb16-14"><a href="#cb16-14"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="co">#f2,inverse transform method</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>x &lt;-<span class="st"> </span><span class="kw">tan</span>(pi<span class="op">/</span><span class="dv">4</span><span class="op">*</span>(u<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb16-17"><a href="#cb16-17"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)<span class="op">/</span>(<span class="dv">4</span><span class="op">/</span>((<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>pi))</span>
<span id="cb16-18"><a href="#cb16-18"></a>theta_hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb16-19"><a href="#cb16-19"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="kw">rbind</span>(theta_hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta_hat 0.4020602 0.4038706
## se        0.1569158 0.3294217</code></pre>
<p>Note that <span class="math inline">\(f_1\)</span> has smaller variance because <span class="math inline">\(f_1\)</span> has a more similiar shape to g. We will illustrate it below:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>w &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>f1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb18-4"><a href="#cb18-4"></a>f2 &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">/</span>((<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>pi)</span>
<span id="cb18-5"><a href="#cb18-5"></a>g &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="dt">lwd =</span> w)</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w)</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w) </span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">plot</span>(x, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see from the picture that <span class="math inline">\(f_1\)</span> is more similiar to g.</p>
</div>
<div id="question2-2" class="section level2">
<h2>Question2</h2>
<p>5.15 Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>k &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>r &lt;-<span class="st"> </span>n<span class="op">/</span>k</span>
<span id="cb20-4"><a href="#cb20-4"></a>N &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb20-8"><a href="#cb20-8"></a>est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb20-11"><a href="#cb20-11"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb20-12"><a href="#cb20-12"></a>  x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb20-13"><a href="#cb20-13"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb20-14"><a href="#cb20-14"></a>  est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){ </span>
<span id="cb20-16"><a href="#cb20-16"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span>k)</span>
<span id="cb20-17"><a href="#cb20-17"></a>    t &lt;-<span class="st"> </span>u <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)<span class="op">+</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>)</span>
<span id="cb20-18"><a href="#cb20-18"></a>    x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(t)</span>
<span id="cb20-19"><a href="#cb20-19"></a>    fg &lt;-<span class="st"> </span><span class="dv">5</span><span class="op">*</span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb20-20"><a href="#cb20-20"></a>    T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb20-21"><a href="#cb20-21"></a>  }</span>
<span id="cb20-22"><a href="#cb20-22"></a>  est[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</span>
<span id="cb20-23"><a href="#cb20-23"></a>} </span>
<span id="cb20-24"><a href="#cb20-24"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</span>
<span id="cb20-25"><a href="#cb20-25"></a>se &lt;-<span class="st"> </span><span class="kw">apply</span>(est,<span class="dv">2</span>,sd)</span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="kw">rbind</span>(theta_hat, se)</span></code></pre></div>
<pre><code>##                   [,1]         [,2]
## theta_hat 0.5247751830 0.5247930146
## se        0.0009004628 0.0001691092</code></pre>
<p>We can see that the standard error in the stratified sampling is approximately <span class="math inline">\(\frac 1 5\)</span> of the importance sampling. The same as theoretical result that the standard error in the stratified sampling is reduced to <span class="math inline">\(\frac 1 k\)</span> of the importance sampling case.</p>
</div>
<div id="question3-2" class="section level2">
<h2>Question3</h2>
<p>Suppose that <span class="math inline">\(X_1,\cdots,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\)</span>% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Assume that <span class="math inline">\(X_1,\cdots,X_n \sim X\)</span> and <span class="math inline">\(lnX \sim N(\mu,\sigma^2)\)</span>, thus we have <span class="math inline">\(lnX_1,\cdots,lnX_n \sim N(\mu,\sigma^2)\)</span>, <span class="math display">\[
\frac{\overline{lnX}-\mu}{S/\sqrt{n}}\sim t_n,
\]</span> where <span class="math inline">\(S^2=\frac 1{n-1}\sum_{i=1}^n(lnX_i-\overline{lnX})^2\)</span>, thus we get the confidence interval, <span class="math display">\[
\left(\frac{1}{n} \sum_{i=1}^n \ln {X_i} - t_n(1-\alpha/2) S / \sqrt{n}, \frac{1}{n} \sum_{i=1}^n \ln {X_i} + t_n(1-\alpha/2) S / \sqrt{n}\right),
\]</span> where <span class="math inline">\(\alpha=0.05\)</span>. We use <span class="math display">\[
P(\left|\frac{\overline{lnX}-\mu}{S/\sqrt{n}}\right| &lt; t_n(1-\alpha/2))=P(\left|\frac{\overline{lnX}-\mu}{t_n(1-\alpha/2)S/\sqrt{n}}\right| &lt; 1)=1-\alpha,
\]</span> to generate empirical estimate of the confidence level.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb22-5"><a href="#cb22-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">var</span>(<span class="kw">log</span>(x)))<span class="op">/</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>  })</span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="kw">mean</span>(<span class="kw">abs</span>(UCL) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.954</code></pre>
<p>We can see that empirical estimate of the confidence level is 0.954, very close to the true value.</p>
</div>
<div id="question4-1" class="section level2">
<h2>Question4</h2>
<p>Suppose a <span class="math inline">\(95 \%\)</span> symmetric <span class="math inline">\(t\)</span> -interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95 .\)</span> Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span> -interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n=20 .\)</span> Compare your <span class="math inline">\(t\)</span> -interval results with the simulation results in Example <span class="math inline">\(6.4 .\)</span> (The <span class="math inline">\(t\)</span> -interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>We generate the empirical estimate of the confidence level the same as question <span class="math inline">\(3\)</span> and example <span class="math inline">\(6.4\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb24-4"><a href="#cb24-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x))<span class="op">/</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a>  })</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="kw">mean</span>(<span class="kw">abs</span>(UCL) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.939</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb26-2"><a href="#cb26-2"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>  (n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,n<span class="dv">-1</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>  })</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.794</code></pre>
<p>We can see that coverage probability of the <span class="math inline">\(t\)</span> -interval is much more close to 0.95 than the interval of the variance. This proves that <span class="math inline">\(t\)</span> -interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="homework-10.27" class="section level2">
<h2>Homework-10.27</h2>
</div>
<div id="question1-3" class="section level2">
<h2>Question1</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha,\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb28-4"><a href="#cb28-4"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb28-7"><a href="#cb28-7"></a>}</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb28-10"><a href="#cb28-10"></a>a &lt;-<span class="st"> </span><span class="fl">.1</span>              <span class="co">#significance level</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>n &lt;-<span class="st"> </span><span class="dv">30</span> </span>
<span id="cb28-12"><a href="#cb28-12"></a>m &lt;-<span class="st"> </span><span class="dv">3000</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>alpha &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">20.1</span>, <span class="dv">1</span>)</span>
<span id="cb28-14"><a href="#cb28-14"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb28-15"><a href="#cb28-15"></a>pwr_Beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>a <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(n <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))))</span>
<span id="cb28-18"><a href="#cb28-18"></a></span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {     <span class="co">#for each alpha </span></span>
<span id="cb28-20"><a href="#cb28-20"></a>  sktests_Beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb28-21"><a href="#cb28-21"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {   <span class="co">#for each replicate</span></span>
<span id="cb28-22"><a href="#cb28-22"></a>    x_Beta &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, alpha[i], alpha[i])</span>
<span id="cb28-23"><a href="#cb28-23"></a>    sktests_Beta[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x_Beta)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb28-24"><a href="#cb28-24"></a>  }</span>
<span id="cb28-25"><a href="#cb28-25"></a>  pwr_Beta[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests_Beta)</span>
<span id="cb28-26"><a href="#cb28-26"></a>}</span>
<span id="cb28-27"><a href="#cb28-27"></a><span class="co">#plot power vs alpha </span></span>
<span id="cb28-28"><a href="#cb28-28"></a><span class="kw">plot</span>(alpha, pwr_Beta, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,</span>
<span id="cb28-29"><a href="#cb28-29"></a>      <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))</span>
<span id="cb28-30"><a href="#cb28-30"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)                         <span class="co">#significance level</span></span>
<span id="cb28-31"><a href="#cb28-31"></a>se_Beta &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr_Beta <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pwr_Beta) <span class="op">/</span><span class="st"> </span>m)  <span class="co">#standard error</span></span>
<span id="cb28-32"><a href="#cb28-32"></a><span class="co">#plot confidence interval</span></span>
<span id="cb28-33"><a href="#cb28-33"></a><span class="kw">lines</span>(alpha, pwr_Beta <span class="op">+</span><span class="st"> </span>se_Beta, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb28-34"><a href="#cb28-34"></a><span class="kw">lines</span>(alpha, pwr_Beta <span class="op">-</span><span class="st"> </span>se_Beta, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curve vs <span class="math inline">\(\alpha\)</span> is shown above. Note that the power curve is below the horizontal line corresponding to a=0.10. This is beacause the skewness of points generated from symmetric beta is always near 0. That makes the test inefficient in the symmetric beta circumstance.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>nu &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">20.1</span>, <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>N2 &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</span>
<span id="cb29-3"><a href="#cb29-3"></a>pwr_t &lt;-<span class="st"> </span><span class="kw">numeric</span>(N2)</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N2) {        <span class="co">#for each nu </span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  skt_t &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {       <span class="co">#for each replicate</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>    x_t &lt;-<span class="st"> </span><span class="kw">rt</span>(n, nu[i])</span>
<span id="cb29-9"><a href="#cb29-9"></a>    skt_t[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x_t)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  }</span>
<span id="cb29-11"><a href="#cb29-11"></a>  pwr_t[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(skt_t)   <span class="co">#power</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>}</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="co">#plot power vs nu</span></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="kw">plot</span>(nu, pwr_t, <span class="dt">xlab =</span> <span class="kw">bquote</span>(nu), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, </span>
<span id="cb29-16"><a href="#cb29-16"></a>     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)                <span class="co">#significance level</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>se_t &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr_t <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pwr_t) <span class="op">/</span><span class="st"> </span>m)  <span class="co">#standard error</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="co">#plot confidence interval</span></span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="kw">lines</span>(nu, pwr_t <span class="op">+</span><span class="st"> </span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb29-21"><a href="#cb29-21"></a><span class="kw">lines</span>(nu, pwr_t <span class="op">-</span><span class="st"> </span>se_t, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curve vs <span class="math inline">\(\nu\)</span> is shown above. Note that the power curve is above the horizontal line corresponding to a=0.10 and power gets smaller as <span class="math inline">\(\nu\)</span> gets bigger. This is because the t-distribution is similiar to normal distribution as nu gets big. Therefore, it is difficult to distinguish one from another and makes the power small. The power is big with small <span class="math inline">\(\nu\)</span>.</p>
<p>All in all, it illustrates that the skewness test of normality is inefficient to symmetric beta and t-distribution with large <span class="math inline">\(\nu\)</span>. We can only use the skewness test of normality to detect t-distribution with small <span class="math inline">\(\nu\)</span>.</p>
</div>
<div id="question2-3" class="section level2">
<h2>Question2</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\doteq0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb30-6"><a href="#cb30-6"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-7"><a href="#cb30-7"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb30-8"><a href="#cb30-8"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb30-9"><a href="#cb30-9"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb30-11"><a href="#cb30-11"></a>}</span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a>power_count &lt;-<span class="st"> </span><span class="cf">function</span>(m,n,sigma1,sigma2){</span>
<span id="cb30-14"><a href="#cb30-14"></a>  tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb30-15"><a href="#cb30-15"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb30-16"><a href="#cb30-16"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb30-17"><a href="#cb30-17"></a>  <span class="kw">count5test</span>(x, y)</span>
<span id="cb30-18"><a href="#cb30-18"></a>  } )</span>
<span id="cb30-19"><a href="#cb30-19"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(tests))</span>
<span id="cb30-20"><a href="#cb30-20"></a>}</span>
<span id="cb30-21"><a href="#cb30-21"></a></span>
<span id="cb30-22"><a href="#cb30-22"></a>power_f &lt;-<span class="st"> </span><span class="cf">function</span>(m,n,sigma1,sigma2){</span>
<span id="cb30-23"><a href="#cb30-23"></a>  tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb30-24"><a href="#cb30-24"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma1)</span>
<span id="cb30-25"><a href="#cb30-25"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma2)</span>
<span id="cb30-26"><a href="#cb30-26"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y,<span class="dt">conf.level=</span><span class="fl">0.945</span>)<span class="op">$</span>p.value<span class="op">&lt;</span><span class="fl">0.055</span>))</span>
<span id="cb30-27"><a href="#cb30-27"></a>  } )</span>
<span id="cb30-28"><a href="#cb30-28"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(tests))</span>
<span id="cb30-29"><a href="#cb30-29"></a>}</span>
<span id="cb30-30"><a href="#cb30-30"></a></span>
<span id="cb30-31"><a href="#cb30-31"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb30-32"><a href="#cb30-32"></a>k =<span class="st"> </span><span class="kw">length</span>(n)</span>
<span id="cb30-33"><a href="#cb30-33"></a>power_<span class="dv">1</span> =<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb30-34"><a href="#cb30-34"></a>power_<span class="dv">2</span> =<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb30-35"><a href="#cb30-35"></a></span>
<span id="cb30-36"><a href="#cb30-36"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb30-37"><a href="#cb30-37"></a>  power_<span class="dv">1</span>[i] &lt;-<span class="st"> </span><span class="kw">power_count</span>(m,n[i],sigma1,sigma2)</span>
<span id="cb30-38"><a href="#cb30-38"></a>  power_<span class="dv">2</span>[i] &lt;-<span class="st"> </span><span class="kw">power_f</span>(m,n[i],sigma1,sigma2)</span>
<span id="cb30-39"><a href="#cb30-39"></a>}</span>
<span id="cb30-40"><a href="#cb30-40"></a>df&lt;-<span class="kw">data.frame</span>(power_<span class="dv">1</span>, power_<span class="dv">2</span>)</span>
<span id="cb30-41"><a href="#cb30-41"></a><span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Count Five test&quot;</span>,<span class="st">&quot;F-test&quot;</span>)</span>
<span id="cb30-42"><a href="#cb30-42"></a><span class="kw">row.names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n=20&quot;</span>, <span class="st">&quot;n=100&quot;</span>, <span class="st">&quot;n=500&quot;</span>)</span>
<span id="cb30-43"><a href="#cb30-43"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Count Five test</th>
<th align="right">F-test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=20</td>
<td align="right">0.3140</td>
<td align="right">0.4197</td>
</tr>
<tr class="even">
<td align="left">n=100</td>
<td align="right">0.8493</td>
<td align="right">0.9828</td>
</tr>
<tr class="odd">
<td align="left">n=500</td>
<td align="right">0.9917</td>
<td align="right">1.0000</td>
</tr>
</tbody>
</table>
<p>We can see that the power of both tests increase as n gets bigger which means that both methods are asmyptotic efficient. And the power of F-test is better than Count Five test in all the circumstances.</p>
</div>
<div id="question3-3" class="section level2">
<h2>Question3</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1, d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}.
\]</span> Under normality, <span class="math inline">\(\beta_{1, d}=0 .\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}.
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1, d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(n b_{1, d} / 6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2) / 6\)</span> degrees of freedom.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#compute the skewness function</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>sk2 &lt;-<span class="st"> </span><span class="cf">function</span>(X) {</span>
<span id="cb31-6"><a href="#cb31-6"></a>        k &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb31-7"><a href="#cb31-7"></a>        Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="kw">colMeans</span>(X),k), <span class="dt">nrow=</span>k, <span class="dt">byrow=</span><span class="ot">TRUE</span>)     <span class="co">#colmean </span></span>
<span id="cb31-8"><a href="#cb31-8"></a>        Sigma &lt;-<span class="st"> </span><span class="kw">t</span>(X<span class="op">-</span>Y)<span class="op">%*%</span>(X<span class="op">-</span>Y)<span class="op">/</span>k                               <span class="co">#covariance         </span></span>
<span id="cb31-9"><a href="#cb31-9"></a>        b &lt;-<span class="st"> </span><span class="kw">sum</span>(((X<span class="op">-</span>Y)<span class="op">%*%</span><span class="kw">solve</span>(Sigma)<span class="op">%*%</span><span class="kw">t</span>(X<span class="op">-</span>Y))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a>        <span class="kw">return</span>(b<span class="op">/</span>k<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>}</span>
<span id="cb31-12"><a href="#cb31-12"></a>sktests=<span class="cf">function</span>(n,cv,d){</span>
<span id="cb31-13"><a href="#cb31-13"></a>  tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {                <span class="co">#tests</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>          x=<span class="kw">mvrnorm</span>(n,<span class="kw">rep</span>(<span class="dv">0</span>,d),<span class="kw">diag</span>(d))         <span class="co">#generation</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>          <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">sk2</span>(x)<span class="op">&gt;=</span>cv)) </span>
<span id="cb31-16"><a href="#cb31-16"></a>          } )</span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="kw">mean</span>(tests)</span>
<span id="cb31-18"><a href="#cb31-18"></a>}</span>
<span id="cb31-19"><a href="#cb31-19"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(d){</span>
<span id="cb31-20"><a href="#cb31-20"></a>         n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb31-21"><a href="#cb31-21"></a>         <span class="co">#critical value for the skewness test</span></span>
<span id="cb31-22"><a href="#cb31-22"></a>         cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">*</span><span class="dv">6</span><span class="op">/</span>n</span>
<span id="cb31-23"><a href="#cb31-23"></a>         p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb31-24"><a href="#cb31-24"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb31-25"><a href="#cb31-25"></a>             p.reject[i] &lt;-<span class="st"> </span><span class="kw">sktests</span>(n[i],cv[i],d)</span>
<span id="cb31-26"><a href="#cb31-26"></a>        }</span>
<span id="cb31-27"><a href="#cb31-27"></a> p.reject          <span class="co">#percent of reject</span></span>
<span id="cb31-28"><a href="#cb31-28"></a>}</span>
<span id="cb31-29"><a href="#cb31-29"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">f</span>(<span class="dv">1</span>), <span class="kw">f</span>(<span class="dv">2</span>))</span>
<span id="cb31-30"><a href="#cb31-30"></a><span class="kw">names</span>(df2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;d=1&quot;</span>,<span class="st">&quot;d=2&quot;</span>)</span>
<span id="cb31-31"><a href="#cb31-31"></a><span class="kw">row.names</span>(df2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;n=10&quot;</span>, <span class="st">&quot;n=20&quot;</span>, <span class="st">&quot;n=30&quot;</span>, <span class="st">&quot;n=50&quot;</span>, <span class="st">&quot;n=100&quot;</span>, <span class="st">&quot;n=500&quot;</span>)</span>
<span id="cb31-32"><a href="#cb31-32"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">d=1</th>
<th align="right">d=2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=10</td>
<td align="right">0.013</td>
<td align="right">0.005</td>
</tr>
<tr class="even">
<td align="left">n=20</td>
<td align="right">0.027</td>
<td align="right">0.022</td>
</tr>
<tr class="odd">
<td align="left">n=30</td>
<td align="right">0.033</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">n=50</td>
<td align="right">0.038</td>
<td align="right">0.035</td>
</tr>
<tr class="odd">
<td align="left">n=100</td>
<td align="right">0.040</td>
<td align="right">0.045</td>
</tr>
<tr class="even">
<td align="left">n=500</td>
<td align="right">0.052</td>
<td align="right">0.063</td>
</tr>
</tbody>
</table>
<p>From above we give the similiar result to exmaple 6.8 in dimension 1 and 2.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>alpha=<span class="fl">0.1</span>            <span class="co">#significance level</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(d,n){</span>
<span id="cb32-3"><a href="#cb32-3"></a>    epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb32-4"><a href="#cb32-4"></a>    N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb32-5"><a href="#cb32-5"></a>    pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="co">#critical value for the skewness test</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>    cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">95</span>, d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">*</span><span class="dv">6</span><span class="op">/</span>n  </span>
<span id="cb32-8"><a href="#cb32-8"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {              <span class="co">#for each epsilon</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>        e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb32-10"><a href="#cb32-10"></a>        sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb32-11"><a href="#cb32-11"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {           <span class="co">#for each replicate</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>                x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)</span>
<span id="cb32-13"><a href="#cb32-13"></a>                <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb32-14"><a href="#cb32-14"></a>                   sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb32-15"><a href="#cb32-15"></a>                                <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))        </span>
<span id="cb32-16"><a href="#cb32-16"></a>                   x[k,] &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>, d), (sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">diag</span>(d))     </span>
<span id="cb32-17"><a href="#cb32-17"></a>                }</span>
<span id="cb32-18"><a href="#cb32-18"></a>              sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk2</span>(x)<span class="op">&gt;=</span>cv)  </span>
<span id="cb32-19"><a href="#cb32-19"></a>        }</span>
<span id="cb32-20"><a href="#cb32-20"></a>        pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)      <span class="co">#power</span></span>
<span id="cb32-21"><a href="#cb32-21"></a>    }  </span>
<span id="cb32-22"><a href="#cb32-22"></a>     <span class="co">#plot power vs epsilon</span></span>
<span id="cb32-23"><a href="#cb32-23"></a>     <span class="kw">plot</span>(epsilon, pwr,<span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,</span>
<span id="cb32-24"><a href="#cb32-24"></a>          <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb32-25"><a href="#cb32-25"></a>     <span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)       <span class="co">#significance level</span></span>
<span id="cb32-26"><a href="#cb32-26"></a>     se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#standard errors</span></span>
<span id="cb32-27"><a href="#cb32-27"></a>     <span class="co">#plot confidence interval</span></span>
<span id="cb32-28"><a href="#cb32-28"></a>     <span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb32-29"><a href="#cb32-29"></a>     <span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>) </span>
<span id="cb32-30"><a href="#cb32-30"></a>}</span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="kw">g</span>(<span class="dv">1</span>,<span class="dv">30</span>) <span class="co">#d=1,n=30</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">g</span>(<span class="dv">2</span>,<span class="dv">30</span>) <span class="co">#d=2,n=30</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From above we plot the similiar picture to exmaple 6.10 in dimension 1 and 2.</p>
</div>
<div id="question4-2" class="section level2">
<h2>Question4</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p><span class="math inline">\((1)\)</span> What is the corresponding hypothesis test problem?</p>
<p><span class="math inline">\((2)\)</span> What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p><span class="math inline">\((3)\)</span> What information is needed to test your hypothesis?</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\((1)\)</span> Let the tests be <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span>. Denote the power of <span class="math inline">\(T_i\)</span> as <span class="math inline">\(\pi_i,\)</span> <span class="math inline">\(i=1,2\)</span>. Thus, the corresponding hypothesis test problem can be described as:<span class="math inline">\(H_0:\pi_1=\pi_2\leftrightarrow H_a:\pi_1\neq\pi_2.\)</span></p>
<p><span class="math inline">\((2)\)</span> As a matter of fact, Z-test, paired-t test and McNemar test all can be used for test except two-sample t-test. This is because two-sample t-test requires that the data of two samples are statistically independent and this is not satisfied as we use the same simulation setting.</p>
<p><span class="math inline">\((3)\)</span> We need to know that in each simulation the null hypothesis was rejected or not for the two tests.</p>
</div>
<div id="homework-11.03" class="section level2">
<h2>Homework-11.03</h2>
</div>
<div id="question1-4" class="section level2">
<h2>Question1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="co">#import data</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb34-3"><a href="#cb34-3"></a>x &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT</span>
<span id="cb34-4"><a href="#cb34-4"></a>y &lt;-<span class="st"> </span>law<span class="op">$</span>GPA</span>
<span id="cb34-5"><a href="#cb34-5"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">cor</span>(x,y)</span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co">#compute the leave-one-out estimates</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>theta_jack &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb34-9"><a href="#cb34-9"></a>  theta_jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x[<span class="op">-</span>i],y[<span class="op">-</span>i])</span>
<span id="cb34-10"><a href="#cb34-10"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_jack) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb34-11"><a href="#cb34-11"></a>se &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_jack) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb34-12"><a href="#cb34-12"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(theta_hat, bias, se) </span>
<span id="cb34-13"><a href="#cb34-13"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_hat</th>
<th align="right">bias</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7763745</td>
<td align="right">-0.0064736</td>
<td align="right">0.1425186</td>
</tr>
</tbody>
</table>
</div>
<div id="question2-4" class="section level2">
<h2>Question2</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>Note that mle of <span class="math inline">\(1/\lambda\)</span> is <span class="math inline">\(\frac{\sum_{i=1}^{n}x_n}n\)</span> which is the sample mean.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">-1</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb35-4"><a href="#cb35-4"></a>B &lt;-<span class="st"> </span><span class="dv">2000</span>                                                         <span class="co">#bootstrap number</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>stat &lt;-<span class="st"> </span><span class="cf">function</span>(dat, index){<span class="kw">mean</span>(dat[index])}                    <span class="co">#function</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>bootstrap_result &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> aircondit<span class="op">$</span>hours, stat, <span class="dt">R =</span> B)     <span class="co">#boot result</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="kw">boot.ci</span>(bootstrap_result, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)) </span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_result, conf = 0.95, type = c(&quot;norm&quot;, 
##     &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.4, 181.4 )   ( 24.3, 170.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.1, 191.9 )   ( 55.6, 224.7 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>We can see that the interval of bca method is larger than the three methods. This is because the interval tends to be too narrow for small n with normal and basic methods.</p>
<p>We get a warning message that BCa intervals may be unstable. This is because the accuracy of the bias and acceleration terms require a large number of bootstrap samples and this can be computationally intensive.</p>
</div>
<div id="question3-4" class="section level2">
<h2>Question3</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="co">#import data</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb37-3"><a href="#cb37-3"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(scor)<span class="op">/</span>n)<span class="op">$</span>values</span>
<span id="cb37-4"><a href="#cb37-4"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb37-5"><a href="#cb37-5"></a>theta_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) </span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </span>
<span id="cb37-7"><a href="#cb37-7"></a>  x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb37-8"><a href="#cb37-8"></a>  m &lt;-<span class="st"> </span>n<span class="dv">-1</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>((m<span class="dv">-1</span>)<span class="op">*</span><span class="kw">cov</span>(x)<span class="op">/</span>m)<span class="op">$</span>values </span>
<span id="cb37-10"><a href="#cb37-10"></a>  theta_jack[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)   </span>
<span id="cb37-11"><a href="#cb37-11"></a>  }</span>
<span id="cb37-12"><a href="#cb37-12"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_jack) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb37-13"><a href="#cb37-13"></a>se &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_jack) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb37-14"><a href="#cb37-14"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(theta_hat, bias, se)</span>
<span id="cb37-15"><a href="#cb37-15"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta_hat</th>
<th align="right">bias</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.619115</td>
<td align="right">0.0010691</td>
<td align="right">0.0495523</td>
</tr>
</tbody>
</table>
</div>
<div id="question4-3" class="section level2">
<h2>Question4</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">data</span>(ironslag, <span class="dt">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>magnetic &lt;-<span class="st"> </span>ironslag<span class="op">$</span>magnetic</span>
<span id="cb38-3"><a href="#cb38-3"></a>chemical &lt;-<span class="st"> </span>ironslag<span class="op">$</span>chemical</span>
<span id="cb38-4"><a href="#cb38-4"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(ironslag) </span>
<span id="cb38-5"><a href="#cb38-5"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb38-10"><a href="#cb38-10"></a>    y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>l)]</span>
<span id="cb38-11"><a href="#cb38-11"></a>    x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>l)]</span>
<span id="cb38-12"><a href="#cb38-12"></a>    </span>
<span id="cb38-13"><a href="#cb38-13"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb38-14"><a href="#cb38-14"></a>    yhat11 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb38-15"><a href="#cb38-15"></a>    yhat12 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[l]</span>
<span id="cb38-16"><a href="#cb38-16"></a>    e1[k,l] &lt;-<span class="st"> </span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat11)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(magnetic[l] <span class="op">-</span><span class="st"> </span>yhat12)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>       <span class="co">#mean error</span></span>
<span id="cb38-17"><a href="#cb38-17"></a>    </span>
<span id="cb38-18"><a href="#cb38-18"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb38-19"><a href="#cb38-19"></a>    yhat21 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>    yhat22 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[l] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[l]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb38-21"><a href="#cb38-21"></a>    e2[k,l] &lt;-<span class="st"> </span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat21)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(magnetic[l] <span class="op">-</span><span class="st"> </span>yhat22)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>      <span class="co">#mean error</span></span>
<span id="cb38-22"><a href="#cb38-22"></a>     </span>
<span id="cb38-23"><a href="#cb38-23"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb38-24"><a href="#cb38-24"></a>    logyhat31 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb38-25"><a href="#cb38-25"></a>    logyhat32 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[l]</span>
<span id="cb38-26"><a href="#cb38-26"></a>    yhat31 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat31)</span>
<span id="cb38-27"><a href="#cb38-27"></a>    yhat32 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat32)</span>
<span id="cb38-28"><a href="#cb38-28"></a>    e3[k,l] &lt;-<span class="st"> </span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat31)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(magnetic[l] <span class="op">-</span><span class="st"> </span>yhat32)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>       <span class="co">#mean error</span></span>
<span id="cb38-29"><a href="#cb38-29"></a>    </span>
<span id="cb38-30"><a href="#cb38-30"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb38-31"><a href="#cb38-31"></a>    logyhat41 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb38-32"><a href="#cb38-32"></a>    logyhat42 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[l])</span>
<span id="cb38-33"><a href="#cb38-33"></a>    yhat41 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat41)</span>
<span id="cb38-34"><a href="#cb38-34"></a>    yhat42 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat42)</span>
<span id="cb38-35"><a href="#cb38-35"></a>    e4[k,l] &lt;-<span class="st"> </span>((magnetic[k] <span class="op">-</span><span class="st"> </span>yhat41)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(magnetic[l] <span class="op">-</span><span class="st"> </span>yhat42)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>       <span class="co">#mean error</span></span>
<span id="cb38-36"><a href="#cb38-36"></a>  }</span>
<span id="cb38-37"><a href="#cb38-37"></a>}</span>
<span id="cb38-38"><a href="#cb38-38"></a>df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">mean</span>(e1), <span class="kw">mean</span>(e2), <span class="kw">mean</span>(e3), <span class="kw">mean</span>(e4))</span>
<span id="cb38-39"><a href="#cb38-39"></a><span class="kw">names</span>(df3)=<span class="kw">c</span>(<span class="st">&quot;mean1&quot;</span>, <span class="st">&quot;mean2&quot;</span>, <span class="st">&quot;mean3&quot;</span>, <span class="st">&quot;mean4&quot;</span>)</span>
<span id="cb38-40"><a href="#cb38-40"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df3)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mean1</th>
<th align="right">mean2</th>
<th align="right">mean3</th>
<th align="right">mean4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">19.57197</td>
<td align="right">17.86985</td>
<td align="right">18.45467</td>
<td align="right">20.46693</td>
</tr>
</tbody>
</table>
<p>According to the predction error criterion, Model 2 would be the best fit for the data. Below is the fitted regression equation and residual plots.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb39-2"><a href="#cb39-2"></a>L2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">plot</span>(L2<span class="op">$</span>fit, L2<span class="op">$</span>res)            <span class="co">#residuals vs fitted values</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)                    <span class="co">#reference line </span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">qqnorm</span>(L2<span class="op">$</span>res)                  <span class="co">#qq plot</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">qqline</span>(L2<span class="op">$</span>res)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////ul9uRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOQklEQVR4nO1dCXvcthF9Uq1WatO0leJeaSz19LpNXW/juKlWlvj/f1WIk+AuCQyunVnZz59WNDiYeXgCARAEsRg+IwpwE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDvRzvQFux1+PN7jMzvt0h4t7/5/3vwXwy1f3M4uDxC0Mvny7l99m+Oe7bBpDb4EUyWqBHl/akr94OxksJDqBcPZ6QaCPL88FCqSqUK1A46HDVMSlRC/QmPVQoA1ECjSScgKpS+InXyvWW5z97SXO/z2eeP8Fzl4N/73Ci9faRtWLL1/PBBrLfaYupPdXwLXzvZS4NRJ8vBmrkMvvg27mAtOBCgUS0JyunUBb98d1hxc/3Ng/+BeO/G7hEhmPzrR4ylFQqw4TrUBKfyfQFFSmQOe/GzkZgR6uFM2t/nuPnxdvh/+NJ8b/fTcSf2VOjKX62b2yvA4ECq7QjVNlOdEK9OFm/G3yh0FFXmLn346FNYWx/PSvre/eRvrmU6ui8OFfY326DATyZ0zVGNYTD9ugMKhMgd6Nf99/3AQF1sWxZTLK+Qo2lvjpz6aAEYFUtcPF91GB3CU6CypUoLF4P1UKuGtipyrPmkCqa3rx1w83M4FcE/YbVV59wZrmK0w08axAZ79246BZUKECGdbEGmQqy+NcINMej4lnv4cp9Pjr//NEE287HwacRg0adIEO2qBlgfRfer+RNj36OM4zfeKwnngg0Cm0QabiH/RiqzXo4v7j3bwNMhJPY4T1xEOBFoJmA8XlT8IIpIpyMA5ab4MOGunB1hPdvHztFVpIPBQoDLoTOQ5ShHYIRtJ/UkfRXuzF37d+HGNh70v/EA6lFxIXBAqCPr2Z38xRgfwsbHh686t7WmJDoKfz5wBwE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDvijx5trvfar62O40wP80ebi/uHqctjkL0l91oA7eLy5HXYYf8pWiTxbwB0ogTZq8c5ngWaAP9pcPt6oFVyfL7EZ4I8ezQLsz/rMgcbuTgZcArV11wFWG5Dtp0O9pHtzvWqa6U4mEPyQMxjszl5vVSNdpRA5LhPgPpGXY1Cr+saBtFoTWtXNk+MyAe4TeTkGMw5SAtUNFMlxmQD3ibwcw1SDNlU3Y+S4XMBQ2QZt9Ys4VfFlo64XQ+Fy9CV3soHmhizu+gHNDVnc9QOaG7K46wfkGQYvzxS+NZQblxtobsjirh/Q3JDFXT+guSGLu35AnuF4i+qboaK3zrKnWY6HZVJLacvZW/Ho4q4BMCyyWkhaz6/x+JUZQz+zm1UEn0FqwYyiE+iZTXcg+PRpyK9Bm6kVeV4TZgg+bQr2UwgOhqkGteAjCRj29Jn9ouVviMbuWmDW3vhjHBquZPdH7q3159UGzRBIhVWj/Tz+aNPimTM5LgewckzLVPk4Izfu8THv2bFstJDNHahJ+wYsGvjogv2BD5aMFjO6gzZP5clxj4vDceFBwmpWf7Srm67PjNsfQe+FhbNkN+6g6mY1P253YPCjRKycJvtpiMbuygH3uXLXtZxaY8jirhwwn6s3pWvpEUN3jT2PSwzB5/p5siOFzcX99nJ4uHoGT1ZVxcHq1WVMyL7cgRoo7tTqjtN/Ng/9E5/ziZ1bNlQDxYdfvNM/5SDH7QgEnwkjsrfBrO5QUx7PQ6DklGHi9JKhmkrcXD+DSwyUKcPE6UXDjd5RNNKJmfvZ6H575LgdoSsPUkZkbxmRtUBbsw37Sl+X464L9LVFmJNPGmQbDkYgK83ahZjjrgdsB08wJHt0B4R7MSWQHSftPRwS8OBQS0OfkKfYLBrGHovJrUFGGVd9KCQoNsuGkffFTCW7HCLTj+S4LQGjjKnA6C1Q/MmqfuNl7MjWpmfJcZvByWJFGrq1QQ4n9mTVKqIbIHNAo0CzWjCsfF+MHLcRMK88dAJUu8NerO6lXnLcRoAfOAe9GDFjY0MWd+l4TpjcwGT7XMfHdZcOl1lxgpy5hubJs3ops+YBIjluNdzAtHBwSs7kDLem596eypQrfONcFpOcyRrupq83OYlebNKHOO45dJBl6B+rBl+2VARy3EpMl1fh7R85lzH00xfbi+9O4BLz7U9pC1QukPxFnAhb58Lrayi/xKI3qy3jFrqfZlUqp1fIGa2hb6Qffl61VJEct9D7/F+Vq0xD383XLfEgxy1zbkfNFY3z5CvX0AwUa7dXIsctc+61qZ67JGevjNPZ3Z5zN/BpMLVLdlAdqau7PefuxrRBFLKLvFjJpcJ57uhAgDYOmxsqbN1U6+qca5Y7KoJxYbMAZD85AYMb/WM+1ZjGzNV9V+C0ueEQG283rv+LnvkFSu4fdPwaFN5XVN1ZHHrONyTsH+SHkUdog4IBYfWd6ZL7bEPS/kHJmX1y3BStoOIEB428DyUCCdo/6OC66tC4kf15QzH7B81UQZtx80KUfEMh+wf1rzwmTIGhiP2D/JDH6VTrcDVOa8PjuJs1zf3kOVmBZv16V5Ddkw2P4W6azeitT65AIvYPmjr3CifkYM0Ne7sLxj7N2MTCNTfs7M41PsNx9Cnv5isnpclx97Jhmk2tik+PmG9onvxs6wZC5Lh7uYIZn5rwOSFzDZ/uzBCa4VYjuKk4lj4lN6ts+wepq8oPDyti5wXNNnQ16Ohv++Do4uio+YbmvfnYzWqXt31sx3Vcecrmg5JjxaZv+8xuuI5cfYZO46CW72pg1u4cXZ9+Ai2/7ZPpzoiiu3cMRxs8zynkG6bfm29Vg2Bqjx8+H61vn3PINHy6S3Zfjd72wTBMc4VHHDwfkMgzpO0ftPK2T8YMl7Vxt6bN7waJIEf1hnULyMlxYVvkDEm7gBx2MiQvvotJmYqrzzPq4kGOPxk+XKUaaYtqgZianRnIBLwhfYuuWoEEyNOvkVYoFciPmWNGxwKyDemNdKFA6hRnszwH8g0rV0in4uozMsRRQLZh703e4IbPMoDmhrXuzKXVOFw50Nyw1p0sffrcrBbG9fcUclqgIoF6bfIGSW2zB7INe23yxnlHGgGyDRtu8ja7luzNe4XPLkC2YbtN3tyPSUAen2MB+YatNnlD4NddXWQ6RwMKDJObvNHcwft1tUdgG805DsL8QCjQ3JDuzvxIrDYBkGv4cHWtH5q2WOUq5pY9AmQa6vGhevjcZqBIDs8GZBrqt+X1N2tUvjd/MsgTSD/nMpOudctf1gLUGDRwkY6RyKrnW+3ijc8CLWTVApnmp26guBagxkCCQLrl0csT23z/yGGACgMRAu3OXj/eqLrT5CuQFgJUGIgQSA2BRn0erhpfYM9HoG5IBkgzqHeRjtEja6MAaQb1LtIxemRtFCDNoN5FOkaPrJ8GwE1AOsBNQDrATUA6wE1AOsBNQDrATUA6wE1AOsBNQDrATUA6wE1AOsBNQDrATUA60Nm/3poyscA4uqCE8DAzviCFwiACFOck4eluLF1in/zHm8g0r3qbfxdXKJqfxCAGlGakwT4piZVgF1sWaRatRx9mRvOTGESBwnxZiFWBHa4jj+LSxYvnpzCIA4X5spB4VBITSC//TyhAEKj8YQ0K8+Vg/evI7Pl19uYvn/j7pwVKMYgApRnp2KVayO4CJRlEgOKcVKT/er0vsYr601OgrRl+bFfZbd34pKqRjuc3cSR/nRNl48pIAQndfEog9q0zo9Ar+1KIFZAwUIwLRGIQAapyJ7E1y7kqGtlt+lYjlT/NIAIU5vtkAG4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtIBbgLSAW4C0gFuAtKBbp6nzWH/Q92JeXe7vGvzlLhLP2a3TujbP8eBJl7WYNY/Ubmu2rkTT3dqmUJ8vYaz/SQFsgupoptAnaZAf7yC/Wolt6jMHDx+9Re1yNkkq031L364cXZ6yyfofLaw/ts89H59Lt3bfDNe07feiT7n4un9+ssEQ7UIMTiB1GJ3+2M3S1MlUMVUe4W4ZN90qASlhtuTxgrktwTfnb/zAk02JoBzor/c2zr2G5AVAK20WIQT6FpfF34HJ7OwTu84cx1s7DSVzdQU/Z1wqnBWIL/SbGd0UOmBjQviBfKOazaNQk35kwjaoPHDFHAshGlEbGkGn+zKFrYxOyAq0NxGq+IFChyXK4TSjCTsCWT7fSuQLc3gk71A7lIam5Dzb6catHiJzWz2BHKOzRs/ktugsAYNrhua1yBrF9Yg/Tu4xKZG+uLe+ZzbLNUgh03ZMkWUZCJjLpDveYM26DbokPfbIN107KZLTHfzT3cX3+sG3TQ5c5u5QPOevrDfR1nJiZgLZHZJ2+ivl3K9mO7UbbL//jKV8HR3aSoGrqeybbRCaq8s9W1f49Ht3Ma2zGEvphzrqlT4wg+aibGEPYH0uES3l24cZL/OzSZv9sZBegnwxlY0DdusjMbqTuYb0wZNNrrf3xsHmSpWvBAYLXQ4Ot40+I4UInC0SCcKcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQDnATkA5wE5AOcBOQjh8BPDK1ZqB6gJoAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="homework-11.10" class="section level2">
<h2>Homework-11.10</h2>
</div>
<div id="question1-5" class="section level2">
<h2>Question1</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>Gather two samples together and randomly split the sample into two part equally to conduct Count 5 test.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb43-2"><a href="#cb43-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb43-3"><a href="#cb43-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb43-4"><a href="#cb43-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb43-5"><a href="#cb43-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))       </span>
<span id="cb43-6"><a href="#cb43-6"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))        <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>}</span>
<span id="cb43-8"><a href="#cb43-8"></a></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)                                     <span class="co"># seed</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span> </span>
<span id="cb43-11"><a href="#cb43-11"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="dv">0</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="dv">1</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)                         <span class="co"># sample generation</span></span>
<span id="cb43-15"><a href="#cb43-15"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb43-16"><a href="#cb43-16"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb43-17"><a href="#cb43-17"></a>R &lt;-<span class="st"> </span><span class="fl">1e4</span>                                            <span class="co"># cycle times</span></span>
<span id="cb43-18"><a href="#cb43-18"></a>n &lt;-<span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb43-19"><a href="#cb43-19"></a>m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span> <span class="op">:</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2))</span>
<span id="cb43-20"><a href="#cb43-20"></a></span>
<span id="cb43-21"><a href="#cb43-21"></a>res &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)                                   <span class="co"># storage </span></span>
<span id="cb43-22"><a href="#cb43-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {                                    <span class="co"># loop</span></span>
<span id="cb43-23"><a href="#cb43-23"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(m, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)         <span class="co"># split</span></span>
<span id="cb43-24"><a href="#cb43-24"></a>  x &lt;-<span class="st"> </span>z[k]</span>
<span id="cb43-25"><a href="#cb43-25"></a>  y &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</span>
<span id="cb43-26"><a href="#cb43-26"></a>  res[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x, y)</span>
<span id="cb43-27"><a href="#cb43-27"></a>}</span>
<span id="cb43-28"><a href="#cb43-28"></a><span class="kw">mean</span>(res)</span></code></pre></div>
<pre><code>## [1] 0.0507</code></pre>
<p>Note that type1 error is close to <span class="math inline">\(0.055\)</span>. We confirm the fact that the permutaion method is effective.</p>
</div>
<div id="question2-5" class="section level2">
<h2>Question2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations:</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations.</p></li>
<li><p>Unequal variances and unequal expectations.</p></li>
<li><p>Non-normal distributions: <span class="math inline">\(t\)</span> distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions).</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls).</p></li>
</ol>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">-1</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">library</span>(RANN)</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="kw">library</span>(Ball)</span>
<span id="cb45-6"><a href="#cb45-6"></a></span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a>m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; </span>
<span id="cb45-9"><a href="#cb45-9"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb45-10"><a href="#cb45-10"></a></span>
<span id="cb45-11"><a href="#cb45-11"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb45-12"><a href="#cb45-12"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb45-14"><a href="#cb45-14"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb45-15"><a href="#cb45-15"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb45-16"><a href="#cb45-16"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb45-17"><a href="#cb45-17"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb45-18"><a href="#cb45-18"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb45-19"><a href="#cb45-19"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb45-20"><a href="#cb45-20"></a>}</span>
<span id="cb45-21"><a href="#cb45-21"></a></span>
<span id="cb45-22"><a href="#cb45-22"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb45-23"><a href="#cb45-23"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb45-24"><a href="#cb45-24"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb45-25"><a href="#cb45-25"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb45-26"><a href="#cb45-26"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb45-27"><a href="#cb45-27"></a>}</span>
<span id="cb45-28"><a href="#cb45-28"></a></span>
<span id="cb45-29"><a href="#cb45-29"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb45-30"><a href="#cb45-30"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb45-31"><a href="#cb45-31"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="fl">0.6</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb45-32"><a href="#cb45-32"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="fl">0.85</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb45-33"><a href="#cb45-33"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb45-34"><a href="#cb45-34"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb45-35"><a href="#cb45-35"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb45-36"><a href="#cb45-36"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb45-37"><a href="#cb45-37"></a>}</span>
<span id="cb45-38"><a href="#cb45-38"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb45-39"><a href="#cb45-39"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb45-40"><a href="#cb45-40"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.36 0.36 0.76</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">barplot</span>(pow,<span class="dt">col =</span> <span class="st">&quot;lightgreen&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Unequal variances and unequal expectations&quot;</span>,</span>
<span id="cb47-2"><a href="#cb47-2"></a>        <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;ball&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Ball method performs best in the unequal variances and unequal expectations circumstance.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; </span>
<span id="cb48-2"><a href="#cb48-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb48-3"><a href="#cb48-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb48-5"><a href="#cb48-5"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">0.4</span>,<span class="dt">sd =</span> <span class="fl">0.6</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb48-6"><a href="#cb48-6"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">0.5</span>,<span class="dt">sd =</span> <span class="fl">0.85</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb48-7"><a href="#cb48-7"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb48-8"><a href="#cb48-8"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb48-9"><a href="#cb48-9"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb48-10"><a href="#cb48-10"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb48-11"><a href="#cb48-11"></a>}</span>
<span id="cb48-12"><a href="#cb48-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb48-13"><a href="#cb48-13"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb48-14"><a href="#cb48-14"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.32 0.34 0.80</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">barplot</span>(pow,<span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Unequal variances and equal expectations&quot;</span>,</span>
<span id="cb50-2"><a href="#cb50-2"></a>        <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;ball&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Ball method performs best in the unequal variances and equal expectations circumstance.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; </span>
<span id="cb51-2"><a href="#cb51-2"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb51-3"><a href="#cb51-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="co"># t distribution with 1 df (heavy-tailed distribution)</span></span>
<span id="cb51-6"><a href="#cb51-6"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df =</span> <span class="dv">1</span>),<span class="dt">ncol=</span>p); </span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="co">#bimodel distribution (mixture of two normal distributions)</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="fl">0.4</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="fl">0.5</span>));</span>
<span id="cb51-9"><a href="#cb51-9"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb51-10"><a href="#cb51-10"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb51-11"><a href="#cb51-11"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb51-12"><a href="#cb51-12"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb51-13"><a href="#cb51-13"></a>}</span>
<span id="cb51-14"><a href="#cb51-14"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb51-15"><a href="#cb51-15"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb51-16"><a href="#cb51-16"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.42 0.82 0.82</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">barplot</span>(pow,<span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Non-normal distributions&quot;</span>,</span>
<span id="cb53-2"><a href="#cb53-2"></a>        <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;ball&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAzFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma225C227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/wMv/25D/27b//7b//9v///8d8GySAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIWUlEQVR4nO2dC3vaNhSGBQkbLOs6SHZt2bJ1HWSXtlncpttgBPz//9N0teWL/AEGEtvf+zxLFKFzLL2RZTu2VxGTSsRjd+CpQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQF2FzQX4qX8tp6I4eG7k7CZisEit93+XbF289tdLka1K08pmxYTIPYSpLbxNAQ9XPW3FaSbnkiQmkKPIqikM4XKkKDgzKpmP0FyU07Q/VdCnH2rxhKJ3q83QpzPkqbZmkzLn69E/61McX8hei/i9yPb6P5KZn82ywra3MiPX3kz6P2FEL3nt6Yvstrme+dm0Fu5JfWxlSK7OrZN/7JpA71OEtcVJDdoBUVCo7Zqi6KXGMrUFFoO/pnYzy/MOON4mbT3BMmiwQmK3I+pIJ3vXyso+TgoKNDrNHE9Qf2vZQ4jaDWyPR7r9Oe3tpwISmpyLQe38d8yhfzpg+zSC/OBHP+nC9Vy7AuS1oaLzU0iSG15ocLGzoDN59Yg9YP8eJgRZMqmSaDXfuJ6gt7IIRhBdsfW3yK9NsmNJ2uTX1NsqTok+2m+aiuKj39cqLF5gpJRWkGy6fm72P/M5nOC9ISdmxlWKijQaz9xPUF3shOvJ94wItUp/cXsempuyE+8mpKWdi9NpqIcxOZHM8l9QbI0dNvVtWaXMyuIE6TzZUav68oFhXrtJ64pSA7nEytCd36pfg2VgkpaFgWpHp7/9HGSEeQi00X64cqsGr8EBKWjNx8b+amgUK/9xDUFmeXs4DPIjGQ9yc+ggZssrvxwfWHW2K1mUF5QqNd+4rqCtIHCyuJvKnY9iMtWq3JBS7cejKvWIFO7+SFdZHKC9ILkbWgpKtegXK9N4rqC9BQqHMWqBBVbls6gweJhmlukzVFsnhzF5M9f6v1M5zOH56ygvjuK6c2phG6jZUexpI9+4tqC1BQqnAdVCSq2LF+DCot07J3ZmNqb9Mxl6U4UM4KSsxmZ1TC2TcvOg9I+eolrC9K/V/WjPif9rqCjKKjQMnAUO38V5a66Nr+PxNkLbw36oBaKZ+qEV50end/m16DkTDpeyWX3+Vt9FNNN3/ln0sVep4lrCOoYFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQYDdBcyGG+vbnyyN15+mxk6BI37jUd0PHuHU72EXQZqpucZsHDnd8mLa57CJoPZF71tLcmd/rkdomwhkE2G8N0qq6AY9igCd1HiR2o2bYln069CDrIP7bBVEzbMs+7TeU6ChHsRYJymfZc/7m07RW0IHSURCKbrwg95xucAXquKDIvSi0FIETxW4L8s6fQ5ca3RakL1YNoYvVbgviDEJE7hqMa1CA9SR9C+QA6QrRjRd05HQUhKIpCERTEIimIBBNQSCagkA0BYFoCgLRFASiKQhEUxCIpiAQTUEgmoJANAWBaAoC0a0VxFvPp0lHQSiagkA0BYFoCgLRFASiKQhEUxCIpiAQTUEgmoJANAWBaAoC0RQEoikIRFMQiG6JoNUo+LpYtwW5JxQrnrXvtiD3cCtnUJD1RD3fSkEVzHszCqokEmMKqmQ1OqOgSjbT8FvhJt2+ryG3RBBOt2+PWyQo9NYzBQWyZHcXCgLpKAik666gLd967qygbd967qqgrd9Z7aqgrd967qogziDEtm89d1bQtm89d1fQlukoCKSjIJCOgkA6CgLpKAikoyCQjoJAOgoC6SgIpKMgkI6CQDoKAukoCKSjIJCOgkA6CgLpKKiQhbeed0pHQSAdBYF0FATSURBIR0EgHQWBdBQE0lEQSEdBIB0FgXQUBNJREEhHQSAdBYF03RXE56Sr4XPS1fApVwCfkwZwBiH4nDSCz0nXhYK2SkdBfKl3R/J3Vvd9b36/uH03d0JBLYaCAAe+WG0fB75YbR8HvtRoHwe+WG0fnEGAA1+sto8DX6y2D54HASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBDi6oM3U/HV2Plh4xWNtrfh/k19PXnp/Kt6dEwgSQ/VdC0qKx9paIwWdfTaLraCkeKytNVLQMFLzRgtKioHGkRDqr93ryfcTof/+7Sour9XNyrkQvevebK6S6EwFVqNvRsL8wVw2VimaIEh30AhyxfK2kf5HO8ZyULIQ2f9MhQqZS0dL0Zupe06baemgVyMbESuLKrwJgvRNIiPIFUubrifqVy+HrwtybylUxPpfPlEDXumdtYB2ox7OWV/OTEQjBKkbalaQLZY2XfbUoLUYs29kK8zNSlU3H4ZuzBmJJk7ONtEQQWpsVpAtljZd2gd4UkGZiigRpHKU35gzE0t9latX/01TZpDcMcZOkCmWNrW/eHuPO5lBriKdQevL15ele1g6g3ShMbuY+p1eOEG6WNo0GYgTlK0wg1cL72b6eSCFXYMGC21z2ZhdTB10nSBdLG+rBu9WYS0lU5EcxbzncPLoo5jyYiaPGDdGkDpQe8VA48g8nJUIylToU5v+n2pqBI5h7jzInkHJMybt9mkLOjR631l9cbKHAxokSK9B5tQoOt3DJQ0SZE4D9Gp9wqdLmiToUaAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI8D8yaPjTmdXAOQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Energy and ball methods perform best in the non-normal distributions circumstance.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; </span>
<span id="cb54-2"><a href="#cb54-2"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span>;n2 &lt;-<span class="st"> </span><span class="dv">100</span>;R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb54-3"><a href="#cb54-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb54-5"><a href="#cb54-5"></a>  x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n1,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="dv">1</span>)); <span class="co"># n1 = 10</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>  y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="dv">2</span>,<span class="dt">sd =</span> <span class="dv">2</span>)); <span class="co"># n2 = 100</span></span>
<span id="cb54-7"><a href="#cb54-7"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb54-8"><a href="#cb54-8"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb54-9"><a href="#cb54-9"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb54-10"><a href="#cb54-10"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value</span>
<span id="cb54-11"><a href="#cb54-11"></a>}</span>
<span id="cb54-12"><a href="#cb54-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb54-13"><a href="#cb54-13"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb54-14"><a href="#cb54-14"></a><span class="kw">print</span>(pow)</span></code></pre></div>
<pre><code>## [1] 0.06 0.50 0.72</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">barplot</span>(pow,<span class="dt">col =</span> <span class="st">&quot;lightgreen&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Unbalanced sample&quot;</span>,<span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;ball&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Ball method performs best in the unbalanced sample circumstance.</p>
</div>
<div id="homework-11.17" class="section level2">
<h2>Homework-11.17</h2>
</div>
<div id="question1-6" class="section level2">
<h2>Question1</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">-1</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="kw">library</span>(GeneralizedHyperbolic)</span>
<span id="cb57-3"><a href="#cb57-3"></a>Laplace.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N){</span>
<span id="cb57-4"><a href="#cb57-4"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb57-5"><a href="#cb57-5"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma)</span>
<span id="cb57-6"><a href="#cb57-6"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb57-7"><a href="#cb57-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb57-9"><a href="#cb57-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb57-10"><a href="#cb57-10"></a>    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">dskewlap</span>(y)<span class="op">/</span><span class="kw">dskewlap</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb57-11"><a href="#cb57-11"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb57-12"><a href="#cb57-12"></a>    <span class="cf">else</span>{</span>
<span id="cb57-13"><a href="#cb57-13"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb57-14"><a href="#cb57-14"></a>      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb57-15"><a href="#cb57-15"></a>    }</span>
<span id="cb57-16"><a href="#cb57-16"></a>  }</span>
<span id="cb57-17"><a href="#cb57-17"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb57-18"><a href="#cb57-18"></a>}</span>
<span id="cb57-19"><a href="#cb57-19"></a>N &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb57-20"><a href="#cb57-20"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>)</span>
<span id="cb57-21"><a href="#cb57-21"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb57-22"><a href="#cb57-22"></a>laplace1&lt;-<span class="kw">Laplace.Metropolis</span>(sigma[<span class="dv">1</span>], N)</span>
<span id="cb57-23"><a href="#cb57-23"></a>laplace2&lt;-<span class="kw">Laplace.Metropolis</span>(sigma[<span class="dv">2</span>], N)</span>
<span id="cb57-24"><a href="#cb57-24"></a>laplace3&lt;-<span class="kw">Laplace.Metropolis</span>(sigma[<span class="dv">3</span>], N)</span>
<span id="cb57-25"><a href="#cb57-25"></a>laplace4&lt;-<span class="kw">Laplace.Metropolis</span>(sigma[<span class="dv">4</span>], N)</span>
<span id="cb57-26"><a href="#cb57-26"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>laplace1<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>laplace2<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>laplace3<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>laplace4<span class="op">$</span>k<span class="op">/</span>N))</span>
<span id="cb57-27"><a href="#cb57-27"></a><span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;acceptance rate&quot;</span>)</span>
<span id="cb57-28"><a href="#cb57-28"></a><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sigma=1&quot;</span>, <span class="st">&quot;sigma=4&quot;</span>, <span class="st">&quot;sigma=9&quot;</span>, <span class="st">&quot;sigma=16&quot;</span>)</span>
<span id="cb57-29"><a href="#cb57-29"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">acceptance rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sigma=1</td>
<td align="right">0.7018</td>
</tr>
<tr class="even">
<td align="left">sigma=4</td>
<td align="right">0.3509</td>
</tr>
<tr class="odd">
<td align="left">sigma=9</td>
<td align="right">0.1645</td>
</tr>
<tr class="even">
<td align="left">sigma=16</td>
<td align="right">0.0944</td>
</tr>
</tbody>
</table>
<p>We can see that the acceptance rate decreased while the variance increased.</p>
</div>
<div id="question2-6" class="section level2">
<h2>Question2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb58-5"><a href="#cb58-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb58-6"><a href="#cb58-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb58-7"><a href="#cb58-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb58-9"><a href="#cb58-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb58-10"><a href="#cb58-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb58-11"><a href="#cb58-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb58-12"><a href="#cb58-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb58-13"><a href="#cb58-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb58-14"><a href="#cb58-14"></a>}</span>
<span id="cb58-15"><a href="#cb58-15"></a>Laplace.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1){</span>
<span id="cb58-16"><a href="#cb58-16"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb58-17"><a href="#cb58-17"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb58-18"><a href="#cb58-18"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb58-19"><a href="#cb58-19"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb58-20"><a href="#cb58-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb58-21"><a href="#cb58-21"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb58-22"><a href="#cb58-22"></a>    <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">dskewlap</span>(y)<span class="op">/</span><span class="kw">dskewlap</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb58-23"><a href="#cb58-23"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb58-24"><a href="#cb58-24"></a>    <span class="cf">else</span>{</span>
<span id="cb58-25"><a href="#cb58-25"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb58-26"><a href="#cb58-26"></a>      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb58-27"><a href="#cb58-27"></a>    }</span>
<span id="cb58-28"><a href="#cb58-28"></a>  }</span>
<span id="cb58-29"><a href="#cb58-29"></a>  <span class="kw">return</span>(x)</span>
<span id="cb58-30"><a href="#cb58-30"></a>}</span>
<span id="cb58-31"><a href="#cb58-31"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb58-32"><a href="#cb58-32"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span></span>
<span id="cb58-33"><a href="#cb58-33"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb58-34"><a href="#cb58-34"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb58-35"><a href="#cb58-35"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb58-36"><a href="#cb58-36"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb58-37"><a href="#cb58-37"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb58-38"><a href="#cb58-38"></a>X[i, ] &lt;-<span class="st"> </span><span class="kw">Laplace.Metropolis</span>(sigma, n, x0[i])</span>
<span id="cb58-39"><a href="#cb58-39"></a></span>
<span id="cb58-40"><a href="#cb58-40"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb58-41"><a href="#cb58-41"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb58-42"><a href="#cb58-42"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb58-43"><a href="#cb58-43"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.070582</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb61-5"><a href="#cb61-5"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2///bkDrbkJDb2//b////tmb/25D//7b//9v////Ij6ttAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFUUlEQVR4nO3dbZuaRhhAYdr0dV9aYxt35f//0C5o3GZd5ow4MA9wzofEK4uDe18DiBJtWkvW1H4A0RMIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIKgzULKZaQGWHmy6BIIGgukALYKo8g+ILCQQJBAkECQQJBAkECQQJBNUGCi9U+1xMIBhOIBhOoA+jfHyhTiAYTiAYTiAYLvxxvjZQ+CkkECQQJBAkECQQVB8ouFB1oOhTSCBIIEggKABQbKH6QMGn0JRAh6b56W8ebpNAu6Z5ePnzW/v6+ITDxd7GpgHaffnW7vrZs3+7RcNtD6ifNy+/dUCHn7/icFsEenj78/hvmzmDIgtNs4ntv8+bExUNtz2gdn86fB2agX30B6DAQgGeB5UfvGRBgOIKTQ20zziKtZGFar/1/P6DIuOXL8YmVn78YsUBCioUBiiqUBygoBvZHUD/fH58arvnz+8747yj2G2PZc5uBtqff+fj88Cv3tIPB9cbciO7Fejwdg7RvZhxaJqBs6y+4/MvI9YbUehGoP4Xf3182g+/Vnhq+Cwstd6AQjcC9Wfnx+c/GpggY9e7AqBuYuySm9c96403hcYBDbwKVmC94YTGAd27gSXWG00oHFC03VBAoFhCNwPhc+S71xtLKNC52PvPIglFBAolFBIoklBMoEBCQYHiCEUFam/47KdJCwsUZRIFBoohFBkoxGYWGijCJAoOVH8SVXvr+fz2c/y/5wUaNVzVWbQEoKq7omUAVZxECwGqR7QYoFpECwKqQ7QooNPRt+wDwTUWX3Dq4WYmWh7QzERLBJqVaJlAM+6MlgrUzmW0YKB2FqNlA7XTGy0eqJ3YaA1A7fvLN+VbCVA/5CRGKwJqJzFaF1A/clmkSYBGXmlfrJJG08ygcVfal6yY0USb2Lgr7ctWxmiqfdC4K+1LV+Dov76d9NWa7jNaP1B730TaBFC/wpFIUwNl/rfweWpGKM08g354X75ON659M5vYj2vPR9omUP8I8pS2C9THSBsH6krvFFd5sjqmIaa1nqyO7JppxSer4/s/07pPVgvkThoSCBIIqga0mCoBJQf9/J8LLFxifUMJBAkECQQJBAkECQQJBAkELebcoFYCQQJBAkECQQJBAkECQQJBAkECQQJBAkHlgVJfgXju9LnMlwWvb6R6+f3r53e6bZjcigN1n45/SD++Q9MBXRa8vpHq9bG/wiRx76xhsisNdHzuPtU8+bnCr48d0GXB6xupDqdLkxL3zhomv9JAL792l38MXSXct//y1xvQZcHrG4nhD81D//WKiXvnDHNDxYGS3xF5XqLbB10WvL6RXsMJaPjemcPkVhrotPEndgHdFtB/g8f3Ba9vwBq6Xz1x78xhcpsdqPt+zS0D0QTvf77lTYx2kfvz1SdPo/euC99JZx1kd+MP82eg5R7ms56m7e54onjeeBb7RLHfiPJONS4LXt9Idd67JO6dNUxunqxCAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQf8B6utR4EoPjXoAAAAASUVORK5CYII=" /><!-- --></p>
<p>We can see that the chain has approximately converged to the target distribution within approximately 3500 iterations when sigma=1.</p>
</div>
<div id="question3-5" class="section level2">
<h2>Question3</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P( t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}} )\]</span> and <span class="math display">\[S_{k}(a)=P( t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}} ),\]</span> for <span class="math inline">\(k=4:25,100,500,1000,\)</span> where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by <span class="math inline">\(Sz\acute{e}kely\)</span> [260].)</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>Use uniroot function to get the intersection points’ abscissa.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>u &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">4</span>,<span class="dv">25</span>),<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>b &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(u))</span>
<span id="cb62-3"><a href="#cb62-3"></a>c &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(u))</span>
<span id="cb62-4"><a href="#cb62-4"></a>s1 &lt;-<span class="st"> </span><span class="cf">function</span>(a){   <span class="co">#S_k-1</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)</span>
<span id="cb62-6"><a href="#cb62-6"></a>}</span>
<span id="cb62-7"><a href="#cb62-7"></a>s2 &lt;-<span class="st"> </span><span class="cf">function</span>(a){   <span class="co">#S_k</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</span>
<span id="cb62-9"><a href="#cb62-9"></a>}</span>
<span id="cb62-10"><a href="#cb62-10"></a>s &lt;-<span class="st"> </span><span class="cf">function</span>(a){   <span class="co">#s1-s2</span></span>
<span id="cb62-11"><a href="#cb62-11"></a>  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k))</span>
<span id="cb62-12"><a href="#cb62-12"></a>}</span>
<span id="cb62-13"><a href="#cb62-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(u)){   </span>
<span id="cb62-14"><a href="#cb62-14"></a>  k &lt;-<span class="st"> </span>u[i]</span>
<span id="cb62-15"><a href="#cb62-15"></a>  b[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(s,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))<span class="op">$</span>root    <span class="co">#get root</span></span>
<span id="cb62-16"><a href="#cb62-16"></a>  c[i] &lt;-<span class="st"> </span><span class="kw">s1</span>(b[i])</span>
<span id="cb62-17"><a href="#cb62-17"></a>}</span>
<span id="cb62-18"><a href="#cb62-18"></a></span>
<span id="cb62-19"><a href="#cb62-19"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(u,b,c)</span>
<span id="cb62-20"><a href="#cb62-20"></a><span class="kw">names</span>(df2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;abscissa&quot;</span>, <span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb62-21"><a href="#cb62-21"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df2)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">abscissa</th>
<th align="right">Y-axis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
<td align="right">0.0738151</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533554</td>
<td align="right">0.0662763</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562745</td>
<td align="right">0.0615686</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584430</td>
<td align="right">0.0583593</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601185</td>
<td align="right">0.0560342</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614522</td>
<td align="right">0.0542735</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625391</td>
<td align="right">0.0528947</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634420</td>
<td align="right">0.0517861</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642039</td>
<td align="right">0.0508755</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648555</td>
<td align="right">0.0501144</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654192</td>
<td align="right">0.0494688</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659115</td>
<td align="right">0.0489143</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663453</td>
<td align="right">0.0484329</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667305</td>
<td align="right">0.0480111</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670746</td>
<td align="right">0.0476385</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673841</td>
<td align="right">0.0473070</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676638</td>
<td align="right">0.0470101</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679179</td>
<td align="right">0.0467426</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681497</td>
<td align="right">0.0465005</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683620</td>
<td align="right">0.0462803</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685573</td>
<td align="right">0.0460791</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687374</td>
<td align="right">0.0458945</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720606</td>
<td align="right">0.0426690</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.729753</td>
<td align="right">0.0418375</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.730905</td>
<td align="right">0.0417344</td>
</tr>
</tbody>
</table>
</div>
<div id="homework-11.24" class="section level2">
<h2>Homework-11.24</h2>
</div>
<div id="question1-7" class="section level2">
<h2>Question1</h2>
<ul>
<li><p>A-B-O blood type problem</p></li>
<li><p>Let the three alleles be A, B, and O.</p>
<pre><code>  |          |    |    |    |    |    |    |    |
  |:---------|:---|:---|:---|:---|:---|:---|:---|
  |Genotype  |AA  |BB  |OO  |AO  |BO  |AB  |Sum |
  |Frequency |p^2 |q^2 |r^2 |2pr |2qr |2pq |1   |
  |Count     |nAA |nBB |nOO |nAO |nBO |nAB |n   |</code></pre></li>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=444\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=132\)</span> (B-type), <span class="math inline">\(n_{OO}=361\)</span> (O-type), <span class="math inline">\(n_{AB}=63\)</span> (AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p></li>
</ul>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>We can obtain the log-likelihood which is <span class="math display">\[l(p,q|n_{AA},n_{BB},n_{OO},n_{A.},n_{B.},n_{AB})=2n_{AA}log(p)+2n_{BB}log(q)+2n_{OO}log(r)+(n_{A.}-n_{AA})log(2pr)+(n_{B.}-n_{BB})log(2qr)+n_{AB}log(2pq), \]</span> where <span class="math inline">\(r=1-p-q\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>p0 &lt;-<span class="st"> </span><span class="fl">0.5</span>; q0 &lt;-<span class="st"> </span><span class="fl">0.3</span>                                   <span class="co"># initial value</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>nA &lt;-<span class="st"> </span><span class="dv">444</span>; nB &lt;-<span class="st"> </span><span class="dv">132</span>; nOO &lt;-<span class="st"> </span><span class="dv">361</span>; nAB &lt;-<span class="st"> </span><span class="dv">63</span>            <span class="co"># data</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span>                         <span class="co"># tolerance</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>                                                            </span>
<span id="cb64-5"><a href="#cb64-5"></a>p &lt;-<span class="st"> </span>p0; q &lt;-<span class="st"> </span>q0</span>
<span id="cb64-6"><a href="#cb64-6"></a>logl &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)                                     <span class="co"># log-likelihood                       </span></span>
<span id="cb64-7"><a href="#cb64-7"></a>k &lt;-<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb64-8"><a href="#cb64-8"></a>L.old &lt;-<span class="st"> </span><span class="kw">c</span>(p0, q0)</span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb64-10"><a href="#cb64-10"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb64-11"><a href="#cb64-11"></a>  a &lt;-<span class="st"> </span>p<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p<span class="dv">-2</span><span class="op">*</span>q)</span>
<span id="cb64-12"><a href="#cb64-12"></a>  b &lt;-<span class="st"> </span>q<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>p<span class="op">-</span>q)</span>
<span id="cb64-13"><a href="#cb64-13"></a>  Hp &lt;-<span class="st"> </span>nA<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>a)<span class="op">+</span>nAB</span>
<span id="cb64-14"><a href="#cb64-14"></a>  Hq &lt;-<span class="st"> </span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>b)<span class="op">+</span>nAB</span>
<span id="cb64-15"><a href="#cb64-15"></a>  Hr &lt;-<span class="st"> </span>nA<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>b)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO</span>
<span id="cb64-16"><a href="#cb64-16"></a>  H2 &lt;-<span class="st"> </span>nA<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>b)<span class="op">+</span>nAB</span>
<span id="cb64-17"><a href="#cb64-17"></a>  logl[i] &lt;-<span class="st"> </span>Hp<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span>Hq<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span>Hr<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>H2<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)    <span class="co"># log-likelihood</span></span>
<span id="cb64-18"><a href="#cb64-18"></a>  p.old &lt;-<span class="st"> </span>p; q.old &lt;-<span class="st"> </span>q                </span>
<span id="cb64-19"><a href="#cb64-19"></a>  p &lt;-<span class="st"> </span>Hp<span class="op">/</span>(Hp<span class="op">+</span>Hq<span class="op">+</span>Hr); q &lt;-<span class="st"> </span>Hq<span class="op">/</span>(Hp<span class="op">+</span>Hq<span class="op">+</span>Hr)                <span class="co"># update</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>  L &lt;-<span class="st"> </span><span class="kw">c</span>(p, q)</span>
<span id="cb64-21"><a href="#cb64-21"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old)<span class="op">/</span>L.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>  L.old &lt;-<span class="st"> </span>L</span>
<span id="cb64-23"><a href="#cb64-23"></a>  k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb64-24"><a href="#cb64-24"></a>}  </span>
<span id="cb64-25"><a href="#cb64-25"></a>p.hat&lt;-p; q.hat&lt;-q</span>
<span id="cb64-26"><a href="#cb64-26"></a>logl&lt;-logl[<span class="dv">1</span><span class="op">:</span>k]</span>
<span id="cb64-27"><a href="#cb64-27"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(p.hat,q.hat))</span>
<span id="cb64-28"><a href="#cb64-28"></a><span class="kw">names</span>(df) &lt;-<span class="st"> &quot;value&quot;</span></span>
<span id="cb64-29"><a href="#cb64-29"></a><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;p.hat&quot;</span>, <span class="st">&quot;q.hat&quot;</span>)</span>
<span id="cb64-30"><a href="#cb64-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">p.hat</td>
<td align="right">0.2976407</td>
</tr>
<tr class="even">
<td align="left">q.hat</td>
<td align="right">0.1027063</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(logl)), logl, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;iteration&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot; log-likelihood&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that the EM algorithm converged in <span class="math inline">\(12\)</span> iterations (within <span class="math inline">\(&lt; 1.5e-8\)</span>) to the estimate and the log-likelihood values are increasing.</p>
</div>
<div id="question2-7" class="section level2">
<h2>Question2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
<div id="answer-25" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a>formulas =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb66-4"><a href="#cb66-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb66-5"><a href="#cb66-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb66-6"><a href="#cb66-6"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb66-7"><a href="#cb66-7"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb66-8"><a href="#cb66-8"></a>)</span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="co">#1 for loops</span></span>
<span id="cb66-10"><a href="#cb66-10"></a>f3 =<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb66-11"><a href="#cb66-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</span>
<span id="cb66-12"><a href="#cb66-12"></a>  f3[[i]] =<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</span>
<span id="cb66-13"><a href="#cb66-13"></a>}</span>
<span id="cb66-14"><a href="#cb66-14"></a>f3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">#2 lapply</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>la3 =<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))</span>
<span id="cb68-3"><a href="#cb68-3"></a>la3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
</div>
<div id="question3-6" class="section level2">
<h2>Question3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="dv">100</span>, </span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a>) </span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># anonymous</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.227748235 0.149994950 0.883108507 0.264311632 0.127448333 0.920913400
##   [7] 0.931294966 0.397824834 0.186032836 0.827777211 0.679364249 0.681804148
##  [13] 0.765292337 0.697016440 0.519683485 0.190377388 0.037312408 0.389007667
##  [19] 0.987306731 0.213516966 0.469453923 0.260356822 0.035520103 0.188985152
##  [25] 0.398950796 0.674235771 0.357375326 0.722854117 0.299920385 0.224471681
##  [31] 0.188041608 0.969567477 0.355925204 0.830743426 0.084848164 0.029084789
##  [37] 0.554507349 0.081002445 0.346120772 0.849636595 0.508356759 0.043204432
##  [43] 0.759333990 0.428173845 0.989367230 0.540508648 0.975219898 0.496502980
##  [49] 0.378205480 0.026046911 0.614273248 0.756848069 0.004530641 0.125469501
##  [55] 0.589426417 0.680088087 0.591129436 0.409742395 0.549733237 0.068884067
##  [61] 0.460903457 0.528185071 0.466381822 0.265211268 0.666161297 0.240404033
##  [67] 0.979468895 0.732099463 0.473083165 0.821075890 0.236983520 0.209609150
##  [73] 0.192307168 0.048508207 0.816193538 0.538143289 0.706754831 0.400589060
##  [79] 0.960858085 0.055077639 0.198504432 0.475232328 0.081050383 0.066484079
##  [85] 0.023812262 0.130528407 0.192283821 0.598449726 0.372639562 0.056456904
##  [91] 0.087985509 0.919338540 0.221305174 0.745371835 0.358558256 0.349803718
##  [97] 0.801603896 0.653685790 0.205898733 0.590258461</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># without anonymous function</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.227748235 0.149994950 0.883108507 0.264311632 0.127448333 0.920913400
##   [7] 0.931294966 0.397824834 0.186032836 0.827777211 0.679364249 0.681804148
##  [13] 0.765292337 0.697016440 0.519683485 0.190377388 0.037312408 0.389007667
##  [19] 0.987306731 0.213516966 0.469453923 0.260356822 0.035520103 0.188985152
##  [25] 0.398950796 0.674235771 0.357375326 0.722854117 0.299920385 0.224471681
##  [31] 0.188041608 0.969567477 0.355925204 0.830743426 0.084848164 0.029084789
##  [37] 0.554507349 0.081002445 0.346120772 0.849636595 0.508356759 0.043204432
##  [43] 0.759333990 0.428173845 0.989367230 0.540508648 0.975219898 0.496502980
##  [49] 0.378205480 0.026046911 0.614273248 0.756848069 0.004530641 0.125469501
##  [55] 0.589426417 0.680088087 0.591129436 0.409742395 0.549733237 0.068884067
##  [61] 0.460903457 0.528185071 0.466381822 0.265211268 0.666161297 0.240404033
##  [67] 0.979468895 0.732099463 0.473083165 0.821075890 0.236983520 0.209609150
##  [73] 0.192307168 0.048508207 0.816193538 0.538143289 0.706754831 0.400589060
##  [79] 0.960858085 0.055077639 0.198504432 0.475232328 0.081050383 0.066484079
##  [85] 0.023812262 0.130528407 0.192283821 0.598449726 0.372639562 0.056456904
##  [91] 0.087985509 0.919338540 0.221305174 0.745371835 0.358558256 0.349803718
##  [97] 0.801603896 0.653685790 0.205898733 0.590258461</code></pre>
</div>
<div id="question4-4" class="section level2">
<h2>Question4</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>Mvap &lt;-<span class="st"> </span><span class="cf">function</span>(x, fun, value){</span>
<span id="cb75-2"><a href="#cb75-2"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(y) <span class="kw">vapply</span>(y, fun, value), x)</span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="kw">unlist</span>(out)</span>
<span id="cb75-4"><a href="#cb75-4"></a>}</span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="kw">options</span>(<span class="dt">warn =</span> <span class="dv">-1</span>)</span>
<span id="cb75-6"><a href="#cb75-6"></a>testlist &lt;-<span class="st"> </span><span class="kw">list</span>(cars, faithful, iris)</span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="kw">Mvap</span>(testlist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        speed         dist    eruptions      waiting Sepal.Length  Sepal.Width 
##    15.400000    42.980000     3.487783    70.897059     5.843333     3.057333 
## Petal.Length  Petal.Width      Species 
##     3.758000     1.199333           NA</code></pre>
</div>
<div id="homework-12.1" class="section level2">
<h2>Homework-12.1</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ul>
<li>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</li>
<li>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">library</span>(GeneralizedHyperbolic)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb77-4"><a href="#cb77-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb77-5"><a href="#cb77-5"></a>rwMetropolosR &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb77-6"><a href="#cb77-6"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb77-7"><a href="#cb77-7"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb77-8"><a href="#cb77-8"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb77-9"><a href="#cb77-9"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb77-10"><a href="#cb77-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb77-11"><a href="#cb77-11"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb77-12"><a href="#cb77-12"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">f</span>(y)<span class="op">/</span><span class="kw">f</span>(x[i<span class="dv">-1</span>]))</span>
<span id="cb77-13"><a href="#cb77-13"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb77-14"><a href="#cb77-14"></a>    <span class="cf">else</span> {</span>
<span id="cb77-15"><a href="#cb77-15"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb77-16"><a href="#cb77-16"></a>      k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb77-17"><a href="#cb77-17"></a>    }</span>
<span id="cb77-18"><a href="#cb77-18"></a>  }</span>
<span id="cb77-19"><a href="#cb77-19"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x,<span class="dt">k =</span> k))</span>
<span id="cb77-20"><a href="#cb77-20"></a>}</span>
<span id="cb77-21"><a href="#cb77-21"></a><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rwMetropolosC(double sigma, double x0, int N){</span></span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="st">  NumericVector x(N+1);</span></span>
<span id="cb77-23"><a href="#cb77-23"></a><span class="st">  double k=0;</span></span>
<span id="cb77-24"><a href="#cb77-24"></a><span class="st">  x[0]=x0;</span></span>
<span id="cb77-25"><a href="#cb77-25"></a><span class="st">  double y=0;</span></span>
<span id="cb77-26"><a href="#cb77-26"></a><span class="st">  NumericVector u(N);</span></span>
<span id="cb77-27"><a href="#cb77-27"></a><span class="st">  for (int i=0;i&lt;N;i++){</span></span>
<span id="cb77-28"><a href="#cb77-28"></a><span class="st">    u[i]=runif(1)[0];</span></span>
<span id="cb77-29"><a href="#cb77-29"></a><span class="st">  }</span></span>
<span id="cb77-30"><a href="#cb77-30"></a><span class="st">  for (int j=1;j&lt;N-1;j++){</span></span>
<span id="cb77-31"><a href="#cb77-31"></a><span class="st">    y=rnorm(1,x[j-1],sigma)[0];</span></span>
<span id="cb77-32"><a href="#cb77-32"></a><span class="st">    if (u[j]&lt;=0.5*exp(-abs(y))/(0.5*exp(-abs(x[j-1]))))</span></span>
<span id="cb77-33"><a href="#cb77-33"></a><span class="st">      x[j]=y;</span></span>
<span id="cb77-34"><a href="#cb77-34"></a><span class="st">    else {</span></span>
<span id="cb77-35"><a href="#cb77-35"></a><span class="st">      x[j]=x[j-1];</span></span>
<span id="cb77-36"><a href="#cb77-36"></a><span class="st">      k++;</span></span>
<span id="cb77-37"><a href="#cb77-37"></a><span class="st">    }</span></span>
<span id="cb77-38"><a href="#cb77-38"></a><span class="st">  }</span></span>
<span id="cb77-39"><a href="#cb77-39"></a><span class="st">  x[N]=k;</span></span>
<span id="cb77-40"><a href="#cb77-40"></a><span class="st">  return x;</span></span>
<span id="cb77-41"><a href="#cb77-41"></a><span class="st">}&#39;</span>)</span>
<span id="cb77-42"><a href="#cb77-42"></a>N &lt;-<span class="st"> </span><span class="fl">2e3</span></span>
<span id="cb77-43"><a href="#cb77-43"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb77-44"><a href="#cb77-44"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb77-45"><a href="#cb77-45"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb77-46"><a href="#cb77-46"></a><span class="co">#rwMetropolosR() returns a list with x and k, with the sample vector and the rejection number. </span></span>
<span id="cb77-47"><a href="#cb77-47"></a>rwR1 &lt;-<span class="st"> </span><span class="kw">rwMetropolosR</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb77-48"><a href="#cb77-48"></a>rwR2 &lt;-<span class="st"> </span><span class="kw">rwMetropolosR</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb77-49"><a href="#cb77-49"></a>rwR3 &lt;-<span class="st"> </span><span class="kw">rwMetropolosR</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb77-50"><a href="#cb77-50"></a>rwR4 &lt;-<span class="st"> </span><span class="kw">rwMetropolosR</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb77-51"><a href="#cb77-51"></a><span class="co">#rwMetropolosC() returns a vector x, with the first N the sample and the last the rejection number.</span></span>
<span id="cb77-52"><a href="#cb77-52"></a>rwC1 &lt;-<span class="st"> </span><span class="kw">rwMetropolosC</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb77-53"><a href="#cb77-53"></a>rwC2 &lt;-<span class="st"> </span><span class="kw">rwMetropolosC</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb77-54"><a href="#cb77-54"></a>rwC3 &lt;-<span class="st"> </span><span class="kw">rwMetropolosC</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb77-55"><a href="#cb77-55"></a>rwC4 &lt;-<span class="st"> </span><span class="kw">rwMetropolosC</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb77-56"><a href="#cb77-56"></a>refline &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</span>
<span id="cb77-57"><a href="#cb77-57"></a>rwR &lt;-<span class="st"> </span><span class="kw">list</span>(rwR1,rwR2,rwR3,rwR4)</span>
<span id="cb77-58"><a href="#cb77-58"></a>rwC &lt;-<span class="st"> </span><span class="kw">list</span>(rwC1,rwC2,rwC3,rwC4)</span>
<span id="cb77-59"><a href="#cb77-59"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb77-60"><a href="#cb77-60"></a>  <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>, rwR[[i]]<span class="op">$</span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[i]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Using R codes&quot;</span>)</span>
<span id="cb77-61"><a href="#cb77-61"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb77-62"><a href="#cb77-62"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmkLZmkNtmtrZmtttmtv+QOgCQOmaQZgCQZjqQkGaQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2tma225C229u22/+2///bkDrbkGbbtmbbtpDb2//b////tmb/25D/27b//7b//9v///+k9YzkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALgElEQVR4nO2d6WLcthWFIVuWUteJK6XpYqlt3IpOGolNq5E1fP8nKxYCBEkABxxecJnc80Oa5S7gN9jIwYCiYSUl1i7A1sWAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExIKDigI734t2z/P96K65Cryc9tS4+POalqsSbp1OLGdUOAElED1mpzgtQlqdVnudZAPrPe1khvnu0r9fi4l9fhLjUVeSoH7nDtJ4v115d+1X6v/2kH/73B/nwz8/G81pcfjaeKsrFR/2ySzZDCwOqTY2QB2IBdY3I1JiL90NAsmY4QJUxv2lcKPWWq2vSU+ZRunzyk83QsoDUn+fmV3WEDtDlo/orD/kgm9LzsRKJGiRN/vD89VZZmFd9zy/aU1ajR/XmjZ9shpYFJAt++Yv/ujzAO43gynYhr7ceICt7iMak/u4X1+FULRTrKf+Y6vXmyUs2Q8sCMsesOw7XBz1072nDagzo6rkfy3uoAsjHuhevDBXbaL1kM1R+olj5fdDXP5rS/3MMyA5zI0CXn20oS6LpBkXZuu58z4M3NeiSzdASgPQBm2YkEf34XnetWTVImv0kui46XoOcp0xz1+W2yWYUvzygWpdQdb62Jzn+XR7JCFCoD1KHVnvTIGNy+PA51Qf1J0062YzilwfkV3o9CqmqH6hB0VGsEq5SSJOPylO+MB7FqnYUu/jUyIHu3bOXbEbxFzhZbecu4qN8/MWxGgOKzYMkClcHqm5m7c2DXIpuHqTCdslmaImzeTX7tdNf/fjDY2AUM3Pgbx9HM2l1+Fd+rLd/0Q/1TNo8PP50LRMYz6//kAOZmT67ZDO0vcsd1bwmQa0NAap0K7Sj3Va0IUC2N5/XZ1BrQ4Carz9czz/7ptaWAG1SDAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQERAxK70VqAaMOVEwMCYkBAvz1AEzMzICpzBkQbd+Fw5TIzICpzBkQblzbchAktzHpGgIQzmzLlR+EmRto0IEEJSEVQEc8HkNCH037qswGZaKKDnutHbkgWzjudZkBBEwYETDpCDCho4gOanf+8AIl2wuJd12NAvXftnKWhAiR2AmhwqTfWs3iAGtfM5iW2iKbOFNetQRhQQwao2SOgWNSigKZFWhtQOGzvUNp+gwTQ9NPVTQISI0CzC2BPU5OAQm/sAFBDCSgZaS+AvFMMz3bWXFqkAInRg9CbMMUJxcLhekftXhsAIihBJiAxfrEIoNdbtcGN+v1/dMOZUH5bU9op3TDpnCoU+iDcY/emP4ssD6hWO2u83t6FTaKAhA+o7zIHUOzJeoBaNHVkAxIIKOByIiA9HY8F6l1j9D+W4oBerjWgQ6SRBfKLMoDEVED+yLCpGmSv/DTUgIbt1XvWNmev+xPLAFKZrhrbXSfCDQqbBnQKITEFULMQoEYz0luRxTa3HAISGNBpVSgDkEPfARJ+wTITnVC4jHD2E8sDdEIhICB7gi/aMoitAbInEl5R44CmlyIAqAGA2lo1tEWJJhdNq0ajmPeRuSFEhNMVAtTYj0W0NWfQ7HITTS5aXjj7gTX9ixoxQJOLEeDjdcO2yxkA8mYaGwHkBthkmtMAjdtrAJBta1sGFG1aTc92aqIgINua7b+VALWz6WQ42+DbWk4HyFaQLEC9j6g8oHYXUK1+J9293r1CD8iOi5ZOCJCd73QvdHW4fA1qJ4hTaxCa6UQADeuIQIC60dwH1HVN3oBaqom93qpzsEmA2ifpMmTNj3ozK6+e9D18QP5HM6jJxfqgSp5p5ANqsgBFqhgEFPRIAmrKA2pqcZMDyFZvUkDdyJQPyCvZMoBk/XmbA6iZCGhsEgcU69TEiF60TZUc5o/3YjFA/YPNBCRCgBIFTRct13B6OA8Q9ssFJNKAbNMOFihW0HTJcg211Dbp5ooiOFk1T0To1bBfCFDvLM32aZsGVMsh7PVWbyifBSg/SRJQN3q1ZwwTAEUTYpOB4fF/0PZ4f6P/qr3oSwPy5r4eIAcnHFGEY8GCZhmamiGP/2/Ru1DYb8Oqd89ZgCaUZgyod6GrmQIIjwlZRRoZHvRe6XXiNh2mBklVVwsActXBjoQW1lqA2vtapO41ZbF0d085Oe/QbwIgnKcQoMbc8iSlun3/eL8GoCYXUE7CEwwrIT7BOzNS5R36RQE1WwHU3rnssM6tgkYnV94EqDeBXhHQn0zVSYxilHmRZ0dsK4BotBSg2do1IGGnQe1TDahpz8TmlC6cjsiwdLgkIP87URoxoPx0RIbpKOMrMZNDeMHGgMTOARGE618m7dFgQH3XEQ3/2xsq7RjQuK0yoJ7reL4zvPZKoT0DGk93EpeA5majMywezjuLYEBBVwYEXBOAqIt5foDIxYBQNnLD8uF8QHRR08kIDcuHM77txY3S2iMg48yAEs6iYUBJZwYEnB2g8mJAKBe54QLhCpxRxHORGy4QjgEhZwYEnM8XEMG3Gs1ZA6IJx4CQMwMCzgwIuy80T2RAOBO14SLhClx8jmaiNlwk3O4BmZXCGTtQnai9A6rtKuro7iZzj2+pLqgMILfSHu8fdKr2DcjbuQztQHWq9g2IaxCS/SUC90Ex2b0Xor9X+K0DKh6OASH/cwE07Qd1+TobQKXCMSDkz4CA/zkAOgj981+qcKT+9ImmlagS4ubl2+fRdsk032osqTKAKjlBrHTtKXWqsZjKnay+fKMAlTpZXUyFAOmtKdQeFlyDgnLTw/h2ybtREUB6+5dGjWPp/Qdyg2barWJ2ojltUAZEY7cjQHAHqmlBzw4Q3oFqWtBzA5SxA9W0oOcGKGMHqmlBzw1Qxg5U04KeG6CMHaimBT07QHgHqvPTbk6e1hIDAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiB5Q6qt7/06bzi7tkNLL756oQ45EDuig7qIZL535Yta3Aw4Jvd7qawqUIceiBmQuqlVXsfftd9bODjnEdWh/EkEYMiBqQOa+P/ELjvXVwA45RHUQNwYNXciQyAEl1zbIz/X3Qu+b7+yQQ0rGizTkSNSATNOPdgDmBmXVTWcHHNLJFAPakCMtDKg1evNEB4g25EhLNzFjdH1H2MRIQ460dCdtjL55IOlRfUBEIUdaeJg3ZZcHRjIma0C0IUdaeqKoiy17VJJZXTuKUYYcif5Uo05P8yu3QMTaAYeE2iZGGXIkPlkFYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAhobUDDvaywekt87ZNuKTC11gY0Wb2VG+6JWwpMrr0B6q396Z4QLScLaDVAL9d60YppYpVsKT9ePLxc//VWbSN3bZazuGUtPTdv9Vj3pC7RurTWAqSP7SDuNKBKHuJBKECyudRqebg6aFUz1HYqGqXteHrrD7sndikwvdYCZNuEAmQqQqUAqeXO5s/d6/cPto74fv4KVvfELQWm11qA2t9ZaEAG1uHCLMPs/uhBKgtQ+16Jjmi1PkjfgcL0QXUYUC3Em38Pa1CkiZn3hsYUWnUUq1TjiNUg96TfB4U7aa0iY/2qgCSdrg+qB4A0ttF+e+Fh3i0Fpi/jap10u1x3MIoNapCcIA873vBE0S0FJtdqNehgWo2bB735uV0i7/dBFw/VaDlvu8T3eH/VeOt9Q3MmEm1nJl1uMjxLWwCk60x099OVtQVAurmVaSDztQlAWxYDAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEB/R+DFagi0X32QAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>, rwC[[i]][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[i]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Using Rcpp&quot;</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a>  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</span>
<span id="cb78-4"><a href="#cb78-4"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co">#acceptance rate with rwMetropolosR</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rwR1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwR2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwR3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwR4<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9785 0.8375 0.5355 0.1055</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co">#acceptance rate with rwMetropolosC</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rwC1[N<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwC2[N<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwC3[N<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rwC4[N<span class="op">+</span><span class="dv">1</span>]<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9780 0.8240 0.5160 0.0915</code></pre>
<p>We can see that two functions get similiar results.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co">#qqplot</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb83-4"><a href="#cb83-4"></a>  QR &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(a)</span>
<span id="cb83-5"><a href="#cb83-5"></a>  Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(rwR[[i]]<span class="op">$</span>x,a)</span>
<span id="cb83-6"><a href="#cb83-6"></a>  <span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Using R codes with sigma=&quot;</span>,sigma[i]),<span class="dt">xlab =</span> <span class="st">&quot;standard Laplace Quantiles&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb83-7"><a href="#cb83-7"></a>  <span class="kw">lines</span>(QR,QR)</span>
<span id="cb83-8"><a href="#cb83-8"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb84-2"><a href="#cb84-2"></a>  QR &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(a)</span>
<span id="cb84-3"><a href="#cb84-3"></a>  Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(rwC[[i]][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>],a)</span>
<span id="cb84-4"><a href="#cb84-4"></a>  <span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Using Rcpp with sigma=&quot;</span>,sigma[i]), <span class="dt">xlab =</span> <span class="st">&quot;standard Laplace Quantiles&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb84-5"><a href="#cb84-5"></a>  <span class="kw">lines</span>(QR,QR)</span>
<span id="cb84-6"><a href="#cb84-6"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The qqplots with R and Rcpp are similiar. We can see that when sigma gets larger, the points are closer to the line.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>summary &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">4</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb85-3"><a href="#cb85-3"></a>  ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(rwR[[i]] &lt;-<span class="st"> </span><span class="kw">rwMetropolosR</span>(sigma[i],x0,N), rwC[[i]] &lt;-<span class="st"> </span><span class="kw">rwMetropolosC</span>(sigma[i],x0,N))</span>
<span id="cb85-4"><a href="#cb85-4"></a>  summary[[i]]&lt;-<span class="kw">list</span>(<span class="kw">paste0</span>(<span class="st">&#39;sigma=&#39;</span>,sigma[i]),<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span>
<span id="cb85-5"><a href="#cb85-5"></a>}</span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="kw">print</span>(summary)</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] &quot;sigma=0.05&quot;
## 
## [[1]][[2]]
##                                         expr       lq  median       uq
## 1 rwR[[i]] &lt;- rwMetropolosR(sigma[i], x0, N) 10573.90 12057.3 14158.45
## 2 rwC[[i]] &lt;- rwMetropolosC(sigma[i], x0, N)   463.85   562.8   739.00
## 
## 
## [[2]]
## [[2]][[1]]
## [1] &quot;sigma=0.5&quot;
## 
## [[2]][[2]]
##                                         expr      lq  median       uq
## 1 rwR[[i]] &lt;- rwMetropolosR(sigma[i], x0, N) 7448.85 8086.20 12428.45
## 2 rwC[[i]] &lt;- rwMetropolosC(sigma[i], x0, N)  496.60  507.05   563.30
## 
## 
## [[3]]
## [[3]][[1]]
## [1] &quot;sigma=2&quot;
## 
## [[3]][[2]]
##                                         expr     lq  median     uq
## 1 rwR[[i]] &lt;- rwMetropolosR(sigma[i], x0, N) 7333.1 7729.75 8300.2
## 2 rwC[[i]] &lt;- rwMetropolosC(sigma[i], x0, N)  494.7  503.95  545.8
## 
## 
## [[4]]
## [[4]][[1]]
## [1] &quot;sigma=16&quot;
## 
## [[4]][[2]]
##                                         expr      lq median     uq
## 1 rwR[[i]] &lt;- rwMetropolosR(sigma[i], x0, N) 7423.25 7840.4 8285.4
## 2 rwC[[i]] &lt;- rwMetropolosC(sigma[i], x0, N)  474.65  481.6  496.7</code></pre>
<p>We can see that the function written by Rcpp is way more faster than the function written by R.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
